
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../explanation/">
      
      
        <link rel="next" href="../../reference/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Tutorial - WILDkCAT Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.1-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20168c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V192c0-13.3-10.7-24-24-24m26.7%20216a26.7%2026.7%200%201%200-53.3%200%2026.7%2026.7%200%201%200%2053.3%200%22/%3E%3C/svg%3E');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-on-e-coli-core-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WILDkCAT Documentation" class="md-header__button md-logo" aria-label="WILDkCAT Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WILDkCAT Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../explanation/" class="md-tabs__link">
        
  
  
    
  
  Explanation

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Tutorial

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/" class="md-tabs__link">
        
  
  
    
  
  References

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WILDkCAT Documentation" class="md-nav__button md-logo" aria-label="WILDkCAT Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    WILDkCAT Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explanation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-create-output-directories" class="md-nav__link">
    <span class="md-ellipsis">
      0 — Create output directories
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-extract-kcat-values-from-e-coli-core-model" class="md-nav__link">
    <span class="md-ellipsis">
      1 — Extract kcat values from E. coli core model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-retrieve-experimental-kcat-values-from-brenda-and-sabio-rk" class="md-nav__link">
    <span class="md-ellipsis">
      2 — Retrieve experimental kcat values from BRENDA and SABIO-RK
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-predict-missing-kcat-values-using-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      3 — Predict missing kcat values using machine learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3 — Predict missing kcat values using machine learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-prepare-input-file-for-catapro" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 - Prepare input file for CataPro
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-integrate-catapro-predictions" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 - Integrate CataPro predictions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-generate-summary-report-currently-in-progress" class="md-nav__link">
    <span class="md-ellipsis">
      4 — Generate summary report (Currently in progress)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="example-on-e-coli-core-model">Example on <em>E. coli</em> Core Model</h1>
<p>This page shows a step-by-step example of the WILDkCAT pipeline on the <em>E. coli</em> core model.</p>
<hr />
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>Install <a href="../../installation/">WILDkCAT</a> from PyPI</li>
<li>Install <a href="https://github.com/zchwang/CataPro">CataPro</a> to predict kcat values using machine learning</li>
<li>Download the <a href="http://bigg.ucsd.edu/static/models/e_coli_core.json">E. coli core model</a></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the files used and created in this tutorial are available in the <a href="https://github.com/h-escoffier/WILDkCAT/tree/main/output">output folder</a> of the WILDkCAT repository</p>
</div>
<hr />
<h2 id="0-create-output-directories">0 — Create output directories</h2>
<p>Ensure all output folders exist to avoid write errors.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;output/machine_learning&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="1-extract-kcat-values-from-e-coli-core-model">1 — Extract kcat values from <em>E. coli</em> core model</h2>
<p>First, for each combination of reaction, enzyme, and substrate(s) in the model, create a TSV file. </p>
<p>Each row corresponds to a unique combination of reaction, enzyme, and substrate(s) and will be used to retrieve experimental kcat values from BRENDA and SABIO-RK in the next step.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">wildkcat</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_extraction</span>

<span class="n">run_extraction</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;model/e_coli_core.json&quot;</span><span class="p">,</span>
    <span class="n">output_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat.tsv&quot;</span>
<span class="p">)</span>
</code></pre></div>
<p>Example of the output file:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">rxn</th>
<th style="text-align: left;">rxn_kegg</th>
<th style="text-align: left;">ec_code</th>
<th style="text-align: left;">direction</th>
<th style="text-align: left;">substrates_name</th>
<th style="text-align: left;">substrates_kegg</th>
<th style="text-align: left;">products_name</th>
<th style="text-align: left;">products_kegg</th>
<th style="text-align: left;">genes</th>
<th style="text-align: left;">uniprot</th>
<th style="text-align: left;">catalytic_enzyme</th>
<th style="text-align: left;">warning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">PFK</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.7.1.11</td>
<td style="text-align: left;">forward</td>
<td style="text-align: left;">ATP C10H12N5O13P3;D-Fructose 6-phosphate</td>
<td style="text-align: left;">C00002;C05345</td>
<td style="text-align: left;">ADP C10H12N5O10P2;D-Fructose 1,6-bisphosphate;H+</td>
<td style="text-align: left;">C00008;C00354;C00080</td>
<td style="text-align: left;">b3916</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">ALCD2x</td>
<td style="text-align: left;">R00754</td>
<td style="text-align: left;">1.1.1.71</td>
<td style="text-align: left;">forward</td>
<td style="text-align: left;">Ethanol;Nicotinamide adenine dinucleotide</td>
<td style="text-align: left;">C00469;C00003</td>
<td style="text-align: left;">Acetaldehyde;H+;Nicotinamide adenine dinucleotide - reduced</td>
<td style="text-align: left;">C00084;C00080;C00004</td>
<td style="text-align: left;">b0356</td>
<td style="text-align: left;">P25437</td>
<td style="text-align: left;">P25437</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><a href="../extract_ecoli_report.html">View the generated report</a></p>
<hr />
<h2 id="2-retrieve-experimental-kcat-values-from-brenda-and-sabio-rk">2 — Retrieve experimental kcat values from BRENDA and SABIO-RK</h2>
<p>This function searches for experimentally measured turnover numbers (kcat values) in the BRENDA and/or SABIO-RK databases for the kcats listed in the input file. 
The retrieved values are filtered based on organism, temperature, and pH conditions. The closest matching kcat values are saved to the output file.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">wildkcat</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_retrieval</span>

<span class="n">run_retrieval</span><span class="p">(</span>
    <span class="n">kcat_file_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat.tsv&quot;</span><span class="p">,</span>
    <span class="n">output_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat_retrieved.tsv&quot;</span><span class="p">,</span>
    <span class="n">organism</span><span class="o">=</span><span class="s2">&quot;Escherichia coli&quot;</span><span class="p">,</span>
    <span class="n">temperature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
    <span class="n">pH_range</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">),</span>
    <span class="n">database</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
    <span class="p">)</span>
</code></pre></div>
<p>Example of the output file:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">rxn</th>
<th style="text-align: left;">rxn_kegg</th>
<th style="text-align: left;">ec_code</th>
<th style="text-align: left;">direction</th>
<th style="text-align: left;">substrates_name</th>
<th style="text-align: left;">substrates_kegg</th>
<th style="text-align: left;">products_name</th>
<th style="text-align: left;">products_kegg</th>
<th style="text-align: left;">genes</th>
<th style="text-align: left;">uniprot</th>
<th style="text-align: left;">catalytic_enzyme</th>
<th style="text-align: left;">warning</th>
<th style="text-align: left;">kcat</th>
<th style="text-align: left;">matching_score</th>
<th style="text-align: left;">kcat_substrate</th>
<th style="text-align: left;">kcat_organism</th>
<th style="text-align: left;">kcat_enzyme</th>
<th style="text-align: left;">kcat_temperature</th>
<th style="text-align: left;">kcat_ph</th>
<th style="text-align: left;">kcat_variant</th>
<th style="text-align: left;">kcat_db</th>
<th style="text-align: left;">kcat_id_percent</th>
<th style="text-align: left;">kcat_organism_score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">PFK</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.7.1.11</td>
<td style="text-align: left;">forward</td>
<td style="text-align: left;">ATP C10H12N5O13P3;D-Fructose 6-phosphate</td>
<td style="text-align: left;">C00002;C05345</td>
<td style="text-align: left;">ADP C10H12N5O10P2;D-Fructose 1,6-bisphosphate;H+</td>
<td style="text-align: left;">C00008;C00354;C00080</td>
<td style="text-align: left;">b3916</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.016</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">D-fructose 6-phosphate</td>
<td style="text-align: left;">Escherichia coli</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;">30.0</td>
<td style="text-align: left;">7.2</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">brenda</td>
<td style="text-align: left;">100.0</td>
<td style="text-align: left;">0.0</td>
</tr>
<tr>
<td style="text-align: left;">ALCD2x</td>
<td style="text-align: left;">R00754</td>
<td style="text-align: left;">1.1.1.71</td>
<td style="text-align: left;">forward</td>
<td style="text-align: left;">Ethanol;Nicotinamide adenine dinucleotide</td>
<td style="text-align: left;">C00469;C00003</td>
<td style="text-align: left;">Acetaldehyde;H+;Nicotinamide adenine dinucleotide - reduced</td>
<td style="text-align: left;">C00084;C00080;C00004</td>
<td style="text-align: left;">b0356</td>
<td style="text-align: left;">P25437</td>
<td style="text-align: left;">P25437</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">13.9</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">ethanol</td>
<td style="text-align: left;">Acinetobacter calcoaceticus</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">brenda</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">4.0</td>
</tr>
</tbody>
</table>
<p><a href="../retrieve_ecoli_report.html">View the generated report</a></p>
<hr />
<h2 id="3-predict-missing-kcat-values-using-machine-learning">3 — Predict missing kcat values using machine learning</h2>
<h3 id="31-prepare-input-file-for-catapro">3.1 - Prepare input file for CataPro</h3>
<p>Prepare the input file for CataPro by filtering out the kcat entries that were not found in the previous step and below a limit score (<code>limit_matching_score</code>). The resulting file will be used to predict missing kcat values using machine learning.</p>
<p>The function also generates a file named <code>output_path_substrates_to_smiles.csv</code> that maps substrate names to their corresponding SMILES. This file will be used to match back the predicted kcat values to the original kcat entries after running CataPro.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">wildkcat</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_prediction_part1</span>

<span class="n">run_prediction_part1</span><span class="p">(</span>
    <span class="n">kcat_file_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat_retrieved.tsv&quot;</span><span class="p">,</span> 
    <span class="n">output_path</span><span class="o">=</span><span class="s2">&quot;output/machine_learning/ecoli_catapro_input.csv&quot;</span><span class="p">,</span>
    <span class="n">limit_matching_score</span><span class="o">=</span><span class="mi">6</span>
    <span class="p">)</span>
</code></pre></div>
<p>The output file <code>ecoli_catapro_input.csv</code> is formatted according to the requirements of <a href="https://github.com/zchwang/CataPro">CataPro</a>, meaning it can be directly used as input for kcat prediction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before running predictions, make sure you have installed CataPro by following the installation instructions provided in their <a href="https://github.com/zchwang/CataPro?tab=readme-ov-file#create-the-catapro-environment">GitHub repository</a>.</p>
</div>
<p>Once installed, you can run CataPro with the following command:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>predict.py<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-inp_fpath<span class="w"> </span>output/machine_learning/ecoli_catapro_input.csv<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-model_dpath<span class="w"> </span>models<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-batch_size<span class="w"> </span><span class="m">64</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-device<span class="w"> </span>cuda:0<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-out_fpath<span class="w"> </span>ecoli_catapro_output.csv
</code></pre></div>
<p><a href="../predict_ecoli_report.html">View the generated report</a></p>
<h3 id="32-integrate-catapro-predictions">3.2 - Integrate CataPro predictions</h3>
<p>After running CataPro with the prepared input file, integrate the predicted kcat values back into the original kcat entries. The function matches the predicted values to the original entries using the substrate names and SMILES mapping file generated in the previous step.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">wildkcat</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_prediction_part2</span>

<span class="n">run_prediction_part2</span><span class="p">(</span>
    <span class="n">kcat_file_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat_retrieved.tsv&quot;</span><span class="p">,</span> 
    <span class="n">catapro_predictions_path</span><span class="o">=</span><span class="s2">&quot;output/machine_learning/ecoli_catapro_output.csv&quot;</span><span class="p">,</span> 
    <span class="n">substrates_to_smiles_path</span><span class="o">=</span><span class="s2">&quot;output/machine_learning/ecoli_catapro_input_substrates_to_smiles.tsv&quot;</span><span class="p">,</span> 
    <span class="n">output_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat_full.tsv&quot;</span><span class="p">,</span>
    <span class="n">limit_matching_score</span><span class="o">=</span><span class="mi">6</span>
    <span class="p">)</span>
</code></pre></div>
<p>Example of the output file:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">rxn</th>
<th style="text-align: left;">rxn_kegg</th>
<th style="text-align: left;">ec_code</th>
<th style="text-align: left;">direction</th>
<th style="text-align: left;">substrates_name</th>
<th style="text-align: left;">substrates_kegg</th>
<th style="text-align: left;">products_name</th>
<th style="text-align: left;">products_kegg</th>
<th style="text-align: left;">genes</th>
<th style="text-align: left;">uniprot</th>
<th style="text-align: left;">catalytic_enzyme</th>
<th style="text-align: left;">warning</th>
<th style="text-align: left;">kcat</th>
<th style="text-align: left;">db</th>
<th style="text-align: left;">matching_score</th>
<th style="text-align: left;">kcat_substrate</th>
<th style="text-align: left;">kcat_organism</th>
<th style="text-align: left;">kcat_enzyme</th>
<th style="text-align: left;">kcat_temperature</th>
<th style="text-align: left;">kcat_ph</th>
<th style="text-align: left;">kcat_variant</th>
<th style="text-align: left;">kcat_id_percent</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">PFK</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.7.1.11</td>
<td style="text-align: left;">forward</td>
<td style="text-align: left;">ATP C10H12N5O13P3; D-Fructose 6-phosphate</td>
<td style="text-align: left;">C00002; C05345</td>
<td style="text-align: left;">ADP C10H12N5O10P2; D-Fructose 1,6-bisphosphate; H+</td>
<td style="text-align: left;">C00008; C00354; C00080</td>
<td style="text-align: left;">b3916</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.016</td>
<td style="text-align: left;">brenda</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">D-fructose 6-phosphate</td>
<td style="text-align: left;">Escherichia coli</td>
<td style="text-align: left;">P0A796</td>
<td style="text-align: left;">30.0</td>
<td style="text-align: left;">7.2</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">100.0</td>
</tr>
<tr>
<td style="text-align: left;">ALCD2x</td>
<td style="text-align: left;">R00754</td>
<td style="text-align: left;">1.1.1.71</td>
<td style="text-align: left;">forward</td>
<td style="text-align: left;">Ethanol;Nicotinamide adenine dinucleotide</td>
<td style="text-align: left;">C00469;C00003</td>
<td style="text-align: left;">Acetaldehyde;H+;Nicotinamide adenine dinucleotide - reduced</td>
<td style="text-align: left;">C00084;C00080;C00004</td>
<td style="text-align: left;">b0356</td>
<td style="text-align: left;">P25437</td>
<td style="text-align: left;">P25437</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">16.0905</td>
<td style="text-align: left;">catapro</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-generate-summary-report-currently-in-progress">4 — Generate summary report (<em>Currently in progress</em>)</h2>
<p>The final output file <code>e_coli_core_kcat_full.tsv</code> contains both experimentally retrieved and machine learning predicted kcat values for each combination of reaction, enzyme, and substrate(s) in the <em>E. coli</em> core model. This file can be used for integration into enzyme-constrained metabolic models.</p>
<p>The result can be visualized and summarized using the function <code>generate_summary_report</code>: </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">wildkcat.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_summary_report</span>

<span class="n">generate_summary_report</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;model/e_coli_core.json&quot;</span><span class="p">,</span> 
    <span class="n">kcat_file_path</span><span class="o">=</span><span class="s2">&quot;output/e_coli_core_kcat_full.tsv&quot;</span>
    <span class="p">)</span>
</code></pre></div>
<p><a href="../general_ecoli_report.html">View the generated report</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.tabs", "navigation.top", "search.suggest", "search.highlight", "content.code.annotate", "content.code.copy", "content.code.fold", "toc.integrate", "header.autohide", "admonition"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>