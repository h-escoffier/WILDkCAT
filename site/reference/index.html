
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tutorial/tutorials/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>References - WILDkCAT Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.1-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20168c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V192c0-13.3-10.7-24-24-24m26.7%20216a26.7%2026.7%200%201%200-53.3%200%2026.7%2026.7%200%201%200%2053.3%200%22/%3E%3C/svg%3E');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#main-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="WILDkCAT Documentation" class="md-header__button md-logo" aria-label="WILDkCAT Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WILDkCAT Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              References
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../explanation/explanation/" class="md-tabs__link">
        
  
  
    
  
  Explanation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../tutorial/tutorials/" class="md-tabs__link">
        
  
  
    
  
  Tutorial

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  References

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="WILDkCAT Documentation" class="md-nav__button md-logo" aria-label="WILDkCAT Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    WILDkCAT Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explanation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extraction" class="md-nav__link">
    <span class="md-ellipsis">
      Extraction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.processing.extract_kcat.run_extraction" class="md-nav__link">
    <span class="md-ellipsis">
      run_extraction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieval
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Retrieval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.processing.retrieve_kcat.run_retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      run_retrieval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.processing.predict_kcat.run_prediction_part1" class="md-nav__link">
    <span class="md-ellipsis">
      run_prediction_part1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.processing.predict_kcat.run_prediction_part2" class="md-nav__link">
    <span class="md-ellipsis">
      run_prediction_part2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-report" class="md-nav__link">
    <span class="md-ellipsis">
      Summary report
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.processing.summary.generate_summary_report" class="md-nav__link">
    <span class="md-ellipsis">
      generate_summary_report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matching-process-and-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      Matching process and scoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Matching process and scoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching" class="md-nav__link">
    <span class="md-ellipsis">
      matching
    </span>
  </a>
  
    <nav class="md-nav" aria-label="matching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.check_catalytic_enzyme" class="md-nav__link">
    <span class="md-ellipsis">
      check_catalytic_enzyme
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.check_organism" class="md-nav__link">
    <span class="md-ellipsis">
      check_organism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.check_pH" class="md-nav__link">
    <span class="md-ellipsis">
      check_pH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.check_substrate" class="md-nav__link">
    <span class="md-ellipsis">
      check_substrate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.check_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      check_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.check_variant" class="md-nav__link">
    <span class="md-ellipsis">
      check_variant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.compute_score" class="md-nav__link">
    <span class="md-ellipsis">
      compute_score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.matching.find_best_match" class="md-nav__link">
    <span class="md-ellipsis">
      find_best_match
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#find-closest-enzyme-and-organism" class="md-nav__link">
    <span class="md-ellipsis">
      Find closest enzyme and organism
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Find closest enzyme and organism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.organism" class="md-nav__link">
    <span class="md-ellipsis">
      organism
    </span>
  </a>
  
    <nav class="md-nav" aria-label="organism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.organism.closest_enz" class="md-nav__link">
    <span class="md-ellipsis">
      closest_enz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.organism.closest_taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      closest_taxonomy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correct-the-kcat-value-using-arrhenius-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Correct the kcat value using Arrhenius equation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correct the kcat value using Arrhenius equation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      temperature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.temperature.arrhenius_equation" class="md-nav__link">
    <span class="md-ellipsis">
      arrhenius_equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.temperature.calculate_ea" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_ea
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.brenda_api" class="md-nav__link">
    <span class="md-ellipsis">
      brenda_api
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brenda_api">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.brenda_api.create_brenda_client" class="md-nav__link">
    <span class="md-ellipsis">
      create_brenda_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.brenda_api.get_brenda_credentials" class="md-nav__link">
    <span class="md-ellipsis">
      get_brenda_credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.brenda_api.get_cofactor" class="md-nav__link">
    <span class="md-ellipsis">
      get_cofactor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.brenda_api.get_turnover_number_brenda" class="md-nav__link">
    <span class="md-ellipsis">
      get_turnover_number_brenda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.brenda_api.get_variant" class="md-nav__link">
    <span class="md-ellipsis">
      get_variant
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.sabio_rk_api" class="md-nav__link">
    <span class="md-ellipsis">
      sabio_rk_api
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sabio_rk_api">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.sabio_rk_api.get_turnover_number_sabio" class="md-nav__link">
    <span class="md-ellipsis">
      get_turnover_number_sabio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.uniprot_api" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_api
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_api">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.uniprot_api.catalytic_activity" class="md-nav__link">
    <span class="md-ellipsis">
      catalytic_activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.uniprot_api.convert_uniprot_to_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      convert_uniprot_to_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.api.uniprot_api.identify_catalytic_enzyme" class="md-nav__link">
    <span class="md-ellipsis">
      identify_catalytic_enzyme
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#machine-learning-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning preprocessing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning preprocessing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro" class="md-nav__link">
    <span class="md-ellipsis">
      catapro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="catapro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro.convert_cid_to_smiles" class="md-nav__link">
    <span class="md-ellipsis">
      convert_cid_to_smiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro.convert_kegg_compound_to_sid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_kegg_compound_to_sid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro.convert_kegg_to_smiles" class="md-nav__link">
    <span class="md-ellipsis">
      convert_kegg_to_smiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro.convert_sid_to_cid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_sid_to_cid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro.create_catapro_input_file" class="md-nav__link">
    <span class="md-ellipsis">
      create_catapro_input_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.machine_learning.catapro.integrate_catapro_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      integrate_catapro_predictions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate-reports" class="md-nav__link">
    <span class="md-ellipsis">
      Generate reports
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generate reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports" class="md-nav__link">
    <span class="md-ellipsis">
      generate_reports
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_extraction" class="md-nav__link">
    <span class="md-ellipsis">
      report_extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_final" class="md-nav__link">
    <span class="md-ellipsis">
      report_final
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_prediction_input" class="md-nav__link">
    <span class="md-ellipsis">
      report_prediction_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      report_retrieval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_shader" class="md-nav__link">
    <span class="md-ellipsis">
      report_shader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_simple" class="md-nav__link">
    <span class="md-ellipsis">
      report_simple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildkcat.utils.generate_reports.report_style" class="md-nav__link">
    <span class="md-ellipsis">
      report_style
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="main-functions">Main functions</h1>
<p>The <strong>WILDkCAT</strong> package is organized into modules: </p>
<ol>
<li>
<p><strong>Extraction</strong> : Extraction of kcat values from the provided model</p>
</li>
<li>
<p><strong>Retrieval</strong> : Retrieval of kcat values using curated databases (BRENDA and SABIO-RK)</p>
</li>
<li>
<p><strong>Prediction</strong> : Prediction of missing and low confidence kcat values using ML-based CataPro model</p>
</li>
<li>
<p><strong>Summary</strong> : Generates an HTML report summarizing the percentage and quality of kcat values identified for the model, along with their data sources.</p>
</li>
</ol>
<hr />
<h2 id="extraction">Extraction</h2>


<div class="doc doc-object doc-function">


<h3 id="wildkcat.processing.extract_kcat.run_extraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wildkcat</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">extract_kcat</span><span class="o">.</span><span class="n">run_extraction</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents first">

        <p>Extracts kcat-related data from a metabolic model and generates output files and an optional HTML report.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the metabolic model file (JSON, MATLAB, or SBML format).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where all the results will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>report</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to generate an HTML report (default: True).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/processing/extract_kcat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_extraction</span><span class="p">(</span><span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                   <span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                   <span class="n">report</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts kcat-related data from a metabolic model and generates output files and an optional HTML report.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model_path (str): Path to the metabolic model file (JSON, MATLAB, or SBML format).</span>
<span class="sd">        output_folder (str): Path to the output folder where all the results will be saved.</span>
<span class="sd">        report (bool, optional): Whether to generate an HTML report (default: True).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Intitialize logging</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;logs/extract_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.log&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">DedupFilter</span><span class="p">())</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="c1"># Run extraction</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">report_statistics</span> <span class="o">=</span> <span class="n">create_kcat_output</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="c1"># Save output</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat.tsv&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output saved to &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
        <span class="n">report_extraction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">report_statistics</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><hr />
<h2 id="retrieval">Retrieval</h2>


<div class="doc doc-object doc-function">


<h3 id="wildkcat.processing.retrieve_kcat.run_retrieval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wildkcat</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">retrieve_kcat</span><span class="o">.</span><span class="n">run_retrieval</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">organism</span><span class="p">,</span> <span class="n">temperature_range</span><span class="p">,</span> <span class="n">pH_range</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents first">

        <p>Retrieves closest kcat values from specified databases for entries in a kcat file, applies filtering criteria, 
and saves the results to an output file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the results will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>organism</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Organism scientific name (e.g. "Escherichia coli", "Homo sapiens").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temperature_range</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Acceptable temperature range for filtering (min, max).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pH_range</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Acceptable pH range for filtering (min, max).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies which database(s) to query for kcat values. 
Options are 'both' (default), 'brenda', or 'sabio_rk'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;both&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>report</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to generate an HTML report using the retrieved data (default: True).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/processing/retrieve_kcat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_retrieval</span><span class="p">(</span><span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                  <span class="n">organism</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                  <span class="n">temperature_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
                  <span class="n">pH_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
                  <span class="n">database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
                  <span class="n">report</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves closest kcat values from specified databases for entries in a kcat file, applies filtering criteria, </span>
<span class="sd">    and saves the results to an output file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        output_folder (str): Path to the output folder where the results will be saved.</span>
<span class="sd">        organism (str): Organism scientific name (e.g. &quot;Escherichia coli&quot;, &quot;Homo sapiens&quot;).</span>
<span class="sd">        temperature_range (tuple): Acceptable temperature range for filtering (min, max).</span>
<span class="sd">        pH_range (tuple): Acceptable pH range for filtering (min, max).</span>
<span class="sd">        database (str, optional): Specifies which database(s) to query for kcat values. </span>
<span class="sd">            Options are &#39;both&#39; (default), &#39;brenda&#39;, or &#39;sabio_rk&#39;.</span>
<span class="sd">        report (bool, optional): Whether to generate an HTML report using the retrieved data (default: True).        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load environment variables</span>
    <span class="n">load_dotenv</span><span class="p">()</span>

    <span class="c1"># Intitialize logging</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;logs/retrieval_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.log&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">DedupFilter</span><span class="p">())</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>


    <span class="c1"># Create a dict with the general criterias</span>
    <span class="n">general_criteria</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Organism&quot;</span><span class="p">:</span> <span class="n">organism</span><span class="p">,</span>
        <span class="s2">&quot;Temperature&quot;</span><span class="p">:</span> <span class="n">temperature_range</span><span class="p">,</span>
        <span class="s2">&quot;pH&quot;</span><span class="p">:</span> <span class="n">pH_range</span>
    <span class="p">}</span>

    <span class="c1"># Read the kcat file</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_folder</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified output folder &#39;</span><span class="si">{</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>

    <span class="n">kcat_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat.tsv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified file &#39;</span><span class="si">{</span><span class="n">kcat_file_path</span><span class="si">}</span><span class="s2">&#39; does not exist in the output folder. Please run the function &#39;run_extraction()&#39; first.&quot;</span><span class="p">)</span>

    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Initialize new columns</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;matching_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Add data of the retrieve kcat values</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_substrate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_organism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_enzyme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_ph&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_variant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;kcat_db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Retrieve kcat values from databases</span>
    <span class="n">request_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">kcat_df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Retrieving kcat values&quot;</span><span class="p">):</span>
        <span class="n">kcat_dict</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>

        <span class="c1"># Extract kcat and matching score</span>
        <span class="n">best_match</span><span class="p">,</span> <span class="n">matching_score</span> <span class="o">=</span> <span class="n">extract_kcat</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
        <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;matching_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matching_score</span>

        <span class="n">request_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">request_count</span> <span class="o">%</span> <span class="mi">300</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">best_match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Assign results to the main dataframe</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;adj_kcat&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_substrate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;Substrate&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_organism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;Organism&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_enzyme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;UniProtKB_AC&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;adj_temp&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_ph&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;pH&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_variant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;EnzymeVariant&#39;</span><span class="p">]</span>
            <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">best_match</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id_perc&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_id_percent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;id_perc&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">best_match</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;organism_score&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="n">kcat_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="s1">&#39;kcat_organism_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_match</span><span class="p">[</span><span class="s1">&#39;organism_score&#39;</span><span class="p">]</span>

    <span class="c1"># Select only one kcat value per reaction and substrate</span>
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">merge_ec</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">)</span>

    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat_retrieved.tsv&quot;</span><span class="p">)</span>
    <span class="n">kcat_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output saved to &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
        <span class="n">report_retrieval</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><hr />
<h2 id="prediction">Prediction</h2>


<div class="doc doc-object doc-function">


<h3 id="wildkcat.processing.predict_kcat.run_prediction_part1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wildkcat</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">predict_kcat</span><span class="o">.</span><span class="n">run_prediction_part1</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">limit_matching_score</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents first">

        <p>Processes kcat data file to generate input files for CataPro prediction.
Optionally, it can produce a summary report of the processed data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the results will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit_matching_score</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Threshold for filtering entries based on matching score.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>report</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to generate a report using the retrieved data (default: True).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/processing/predict_kcat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_prediction_part1</span><span class="p">(</span><span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">limit_matching_score</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                         <span class="n">report</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes kcat data file to generate input files for CataPro prediction.</span>
<span class="sd">    Optionally, it can produce a summary report of the processed data.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        output_folder (str): Path to the output folder where the results will be saved.</span>
<span class="sd">        limit_matching_score (int): Threshold for filtering entries based on matching score.</span>
<span class="sd">        report (bool, optional): Whether to generate a report using the retrieved data (default: True). </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Intitialize logging</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;logs/prediction1_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.log&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">DedupFilter</span><span class="p">())</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="c1"># Run prediction part 1</span>
    <span class="c1"># Read the kcat file</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_folder</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified output folder &#39;</span><span class="si">{</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>

    <span class="n">kcat_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat_retrieved.tsv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified file &#39;</span><span class="si">{</span><span class="n">kcat_file_path</span><span class="si">}</span><span class="s2">&#39; does not exist in the output folder. Please run the function &#39;run_retrieval()&#39; first.&quot;</span><span class="p">)</span>

    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Subset rows with no values or matching score above the limit</span>
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">kcat_df</span><span class="p">[(</span><span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;matching_score&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">limit_matching_score</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;matching_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span>
    <span class="c1"># Drop rows with no UniProt ID or no substrates_kegg</span>
    <span class="n">before_duplicates_filter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> 
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">kcat_df</span><span class="p">[</span><span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;uniprot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;substrates_kegg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    <span class="n">nb_missing_enzymes</span> <span class="o">=</span> <span class="n">before_duplicates_filter</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 

    <span class="c1"># Generate CataPro input file</span>
    <span class="n">catapro_input_df</span><span class="p">,</span> <span class="n">substrates_to_smiles_df</span><span class="p">,</span> <span class="n">report_statistics</span> <span class="o">=</span> <span class="n">create_catapro_input_file</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">)</span>

    <span class="c1"># Save the CataPro input file and substrates to SMILES mapping</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;machine_learning&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;machine_learning/catapro_input.csv&quot;</span><span class="p">)</span>
    <span class="n">kcat_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">catapro_input_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">substrates_to_smiles_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;_substrates_to_smiles.tsv&#39;</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output saved to &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Add statistics </span>
    <span class="n">report_statistics</span><span class="p">[</span><span class="s2">&quot;missing_enzymes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nb_missing_enzymes</span>

    <span class="k">if</span> <span class="n">report</span><span class="p">:</span>
        <span class="n">report_prediction_input</span><span class="p">(</span><span class="n">catapro_input_df</span><span class="p">,</span> <span class="n">report_statistics</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wildkcat.processing.predict_kcat.run_prediction_part2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wildkcat</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">predict_kcat</span><span class="o">.</span><span class="n">run_prediction_part2</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">catapro_predictions_path</span><span class="p">,</span> <span class="n">limit_matching_score</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents first">

        <p>Runs the second part of the kcat prediction pipeline by integrating Catapro predictions,
mapping substrates to SMILES, formatting the output, and optionally generating a report.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the results will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catapro_predictions_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the CataPro predictions CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit_matching_score</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Threshold for taking predictions over retrieved values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/processing/predict_kcat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_prediction_part2</span><span class="p">(</span><span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">catapro_predictions_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">limit_matching_score</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the second part of the kcat prediction pipeline by integrating Catapro predictions,</span>
<span class="sd">    mapping substrates to SMILES, formatting the output, and optionally generating a report.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        output_folder (str): Path to the output folder where the results will be saved.</span>
<span class="sd">        catapro_predictions_path (str): Path to the CataPro predictions CSV file.</span>
<span class="sd">        limit_matching_score (float): Threshold for taking predictions over retrieved values.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="c1"># Intitialize logging</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;logs/prediction2_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.log&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">DedupFilter</span><span class="p">())</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="c1"># Run prediction part 2</span>
    <span class="c1"># Read the kcat file</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_folder</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified output folder &#39;</span><span class="si">{</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>
    <span class="n">kcat_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat_retrieved.tsv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified file &#39;</span><span class="si">{</span><span class="n">kcat_file_path</span><span class="si">}</span><span class="s2">&#39; does not exist in the output folder. Please run the function &#39;run_extraction()&#39; first.&quot;</span><span class="p">)</span>
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">substrates_to_smiles_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;machine_learning/catapro_input_substrates_to_smiles.tsv&quot;</span><span class="p">)</span>
    <span class="n">substrates_to_smiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">substrates_to_smiles_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">catapro_predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">catapro_predictions_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">integrate_catapro_predictions</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">,</span> 
                                            <span class="n">substrates_to_smiles</span><span class="p">,</span>
                                            <span class="n">catapro_predictions_df</span>
                                            <span class="p">)</span>

    <span class="c1"># Save the output as a TSV file</span>
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">format_output</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">,</span> <span class="n">limit_matching_score</span><span class="p">)</span>
    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat_full.tsv&quot;</span><span class="p">)</span>
    <span class="n">kcat_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output saved to &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><hr />
<h2 id="summary-report">Summary report</h2>


<div class="doc doc-object doc-function">


<h3 id="wildkcat.processing.summary.generate_summary_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wildkcat</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">generate_summary_report</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents first">

        <p>Generate a HTML report summarizing the kcat extraction, retrieval and prediction for a given model. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the metabolic model file (JSON, MATLAB, or SBML format).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the kcat file is located.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/processing/summary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_summary_report</span><span class="p">(</span><span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                            <span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a HTML report summarizing the kcat extraction, retrieval and prediction for a given model. </span>

<span class="sd">    Parameters:</span>
<span class="sd">        model_path (str): Path to the metabolic model file (JSON, MATLAB, or SBML format).</span>
<span class="sd">        output_folder (str): Path to the output folder where the kcat file is located.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Read the kcat file</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_folder</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified output folder &#39;</span><span class="si">{</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">&#39; does not exist.&quot;</span><span class="p">)</span>

    <span class="n">kcat_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;kcat_full.tsv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified file &#39;</span><span class="si">{</span><span class="n">kcat_file_path</span><span class="si">}</span><span class="s2">&#39; does not exist in the output folder. Please run the full pipeline.&quot;</span><span class="p">)</span>
    <span class="n">kcat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">kcat_file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">read_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
    <span class="n">report_final</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kcat_df</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><hr />
<h2 id="matching-process-and-scoring">Matching process and scoring</h2>
<p>The matching process is designed to select the most appropriate kcat value when multiple candidates are available.<br />
Each candidate is first assigned a score based on several criteria, such as:  </p>
<ul>
<li><strong>kcat specific criteria:</strong><ul>
<li>Substrate</li>
<li>Catalytic enzyme(s)</li>
</ul>
</li>
<li><strong>General criteria:</strong><ul>
<li>Organism</li>
<li>Temperature</li>
<li>pH</li>
</ul>
</li>
</ul>
<p>If two or more candidates receive the same score, tie-breaking rules are applied in the following order:  </p>
<ol>
<li><strong>Enzyme sequence identity</strong>  the value associated with the most similar protein sequence is preferred.  </li>
<li><strong>Organism proximity</strong>  preference is given to kcat values measured in organisms closest to the target species.  </li>
<li><strong>Minimal kcat value</strong>  if ambiguity remains, the smallest kcat value is chosen. </li>
</ol>


<div class="doc doc-object doc-module">



<h3 id="wildkcat.utils.matching" class="doc doc-heading">
            <code>wildkcat.utils.matching</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.check_catalytic_enzyme" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_catalytic_enzyme</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">kcat_dict</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the enzyme in a candidate entry matches the model's enzyme.
Identifies the catalytic enzyme using UniProt API.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_catalytic_enzyme</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">kcat_dict</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the enzyme in a candidate entry matches the model&#39;s enzyme.</span>
<span class="sd">    Identifies the catalytic enzyme using UniProt API.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">[</span><span class="s1">&#39;catalytic_enzyme&#39;</span><span class="p">]):</span>
        <span class="n">catalytic_enzymes</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">[</span><span class="s1">&#39;catalytic_enzyme&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">candidate</span><span class="p">[</span><span class="s2">&quot;UniProtKB_AC&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">catalytic_enzymes</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.check_organism" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_organism</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the organism in a candidate entry matches the expected organism.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_organism</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the organism in a candidate entry matches the expected organism.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">candidate</span><span class="p">[</span><span class="s2">&quot;Organism&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;Organism&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.check_pH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_pH</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the pH in a candidate entry matches the expected pH.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_pH</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the pH in a candidate entry matches the expected pH.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ph_min</span><span class="p">,</span> <span class="n">ph_max</span> <span class="o">=</span> <span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span>
    <span class="n">candidate_ph</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pH&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ph_min</span> <span class="o">&lt;=</span> <span class="n">candidate_ph</span> <span class="o">&lt;=</span> <span class="n">ph_max</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">candidate_ph</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Out of range</span>
        <span class="k">return</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.check_substrate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_substrate</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">kcat_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">candidate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the substrate in a candidate entry matches the model's substrates.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_substrate</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">kcat_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">candidate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the substrate in a candidate entry matches the model&#39;s substrates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;db&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidate</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Normalisation des champs</span>
    <span class="n">entry_subs</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">entry_prods</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Product&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">entry_kegg</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;KeggReactionID&quot;</span><span class="p">)</span>

    <span class="n">cand_subs</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidate</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="n">cand_prods</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Product&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidate</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="n">cand_kegg</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;KeggReactionID&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">candidate</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="n">model_subs</span> <span class="o">=</span> <span class="p">(</span><span class="n">kcat_dict</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;substrates_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">model_prods</span> <span class="o">=</span> <span class="p">(</span><span class="n">kcat_dict</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;products_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">model_kegg</span> <span class="o">=</span> <span class="p">(</span><span class="n">kcat_dict</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rxn_kegg&quot;</span><span class="p">)</span>

    <span class="c1"># --- logique identique  avant ---</span>
    <span class="k">if</span> <span class="n">api</span> <span class="o">==</span> <span class="s2">&quot;sabio_rk&quot;</span><span class="p">:</span>

        <span class="n">entry_kegg</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">entry_kegg</span><span class="p">)</span> <span class="k">else</span> <span class="n">entry_kegg</span>
        <span class="n">model_kegg</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">model_kegg</span><span class="p">)</span> <span class="k">else</span> <span class="n">model_kegg</span>
        <span class="n">cand_kegg</span>  <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">cand_kegg</span><span class="p">)</span> <span class="k">else</span> <span class="n">cand_kegg</span>

        <span class="k">if</span> <span class="n">model_kegg</span> <span class="ow">and</span> <span class="n">entry_kegg</span> <span class="ow">and</span> <span class="n">_norm_name</span><span class="p">(</span><span class="n">model_kegg</span><span class="p">)</span> <span class="o">==</span> <span class="n">_norm_name</span><span class="p">(</span><span class="n">entry_kegg</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">_any_intersection</span><span class="p">(</span><span class="n">entry_subs</span><span class="p">,</span> <span class="n">model_subs</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_any_intersection</span><span class="p">(</span><span class="n">entry_prods</span><span class="p">,</span> <span class="n">model_prods</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">cand_kegg</span> <span class="ow">and</span> <span class="n">entry_kegg</span> <span class="ow">and</span> <span class="n">_norm_name</span><span class="p">(</span><span class="n">cand_kegg</span><span class="p">)</span> <span class="o">==</span> <span class="n">_norm_name</span><span class="p">(</span><span class="n">entry_kegg</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">_any_intersection</span><span class="p">(</span><span class="n">entry_subs</span><span class="p">,</span> <span class="n">cand_subs</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_any_intersection</span><span class="p">(</span><span class="n">entry_prods</span><span class="p">,</span> <span class="n">cand_prods</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="n">base_subs</span> <span class="o">=</span> <span class="n">model_subs</span> <span class="ow">or</span> <span class="n">cand_subs</span>
        <span class="k">if</span> <span class="n">_any_intersection</span><span class="p">(</span><span class="n">entry_subs</span><span class="p">,</span> <span class="n">base_subs</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="mi">3</span>

    <span class="k">elif</span> <span class="n">api</span> <span class="o">==</span> <span class="s2">&quot;brenda&quot;</span><span class="p">:</span>
        <span class="n">base_subs</span> <span class="o">=</span> <span class="n">model_subs</span> <span class="ow">or</span> <span class="n">cand_subs</span>
        <span class="k">if</span> <span class="n">_any_intersection</span><span class="p">(</span><span class="n">entry_subs</span><span class="p">,</span> <span class="n">base_subs</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="mi">3</span>

    <span class="k">return</span> <span class="mi">3</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.check_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_temperature</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">min_r2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">expected_range</span><span class="o">=</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">150000</span><span class="p">))</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the temperature in a candidate entry matches the expected temperature.
If the temperature is within the specified range is not met, verify if the Arrhenius equation can be applied.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_temperature</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">min_r2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">expected_range</span><span class="o">=</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">150000</span><span class="p">)):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the temperature in a candidate entry matches the expected temperature.</span>
<span class="sd">    If the temperature is within the specified range is not met, verify if the Arrhenius equation can be applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">temp_min</span><span class="p">,</span> <span class="n">temp_max</span> <span class="o">=</span> <span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span>
    <span class="n">candidate_temp</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">temp_min</span> <span class="o">&lt;=</span> <span class="n">candidate_temp</span> <span class="o">&lt;=</span> <span class="n">temp_max</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="c1"># Try to find a correct the kcat value using the Arrhenius equation</span>
    <span class="n">ph_min</span><span class="p">,</span> <span class="n">ph_max</span> <span class="o">=</span> <span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span>

    <span class="c1"># Base filters</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">ph_min</span><span class="p">,</span> <span class="n">ph_max</span><span class="p">)</span>
        <span class="o">&amp;</span> <span class="p">(</span><span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;UniProtKB_AC&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">candidate</span><span class="p">[</span><span class="s2">&quot;UniProtKB_AC&quot;</span><span class="p">])</span>
        <span class="o">&amp;</span> <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
        <span class="o">&amp;</span> <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="n">valid_idx</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">check_substrate</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">candidate</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>

    <span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span> <span class="o">&amp;</span> <span class="n">valid_idx</span>

    <span class="n">temps_dispo</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filters</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    <span class="n">api_filtered</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filters</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Convert temperatures to Kelvin</span>
    <span class="n">api_filtered</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_filtered</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span>

    <span class="k">if</span> <span class="n">temps_dispo</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">ea</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">calculate_ea</span><span class="p">(</span><span class="n">api_filtered</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r2</span> <span class="o">&gt;=</span> <span class="n">min_r2</span> <span class="ow">and</span> <span class="n">ea</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">expected_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">ea</span> <span class="o">&lt;=</span> <span class="n">expected_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">candidate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ECNumber&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: Estimated Ea (</span><span class="si">{</span><span class="n">ea</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> J/mol) is outside the expected range </span><span class="si">{</span><span class="n">expected_range</span><span class="si">}</span><span class="s2"> J/mol.&quot;</span><span class="p">)</span>
            <span class="c1"># Go Arrhenius</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">candidate_temp</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.check_variant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_variant</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks whether the enzyme variant in a candidate entry is wildtype or unknown.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_variant</span><span class="p">(</span><span class="n">candidate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the enzyme variant in a candidate entry is wildtype or unknown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">candidate</span><span class="p">[</span><span class="s2">&quot;EnzymeVariant&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;wildtype&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Unknown</span>
        <span class="k">return</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.compute_score" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_score</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Compute a score for the candidate based on the Kcat dictionary and general criteria.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_score</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute a score for the candidate based on the Kcat dictionary and general criteria.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Check catalytic enzyme</span>
    <span class="n">score</span> <span class="o">+=</span> <span class="n">check_catalytic_enzyme</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">kcat_dict</span><span class="p">)</span>
    <span class="c1"># Check organism</span>
    <span class="k">if</span> <span class="n">score</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="n">score</span> <span class="o">+=</span> <span class="n">check_organism</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span>
    <span class="c1"># Check variant</span>
    <span class="n">score</span> <span class="o">+=</span> <span class="n">check_variant</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span> 
    <span class="c1"># Check pH</span>
    <span class="n">score</span> <span class="o">+=</span> <span class="n">check_pH</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span>
    <span class="c1"># Check substrate </span>
    <span class="n">score</span> <span class="o">+=</span> <span class="n">check_substrate</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">kcat_dict</span><span class="p">)</span>
    <span class="c1"># Check temperature </span>
    <span class="n">temperature_penalty</span><span class="p">,</span> <span class="n">arrhenius</span> <span class="o">=</span> <span class="n">check_temperature</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span> 
    <span class="n">score</span> <span class="o">+=</span> <span class="n">temperature_penalty</span>
    <span class="k">return</span> <span class="n">score</span><span class="p">,</span> <span class="n">arrhenius</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.matching.find_best_match" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_best_match</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">



<details class="finds-the-best-matching-enzyme-entry-from-the-provided-api-output-based-on" open>
  <summary>Finds the best matching enzyme entry from the provided API output based on</summary>
  <ul>
<li>Kcat specific criteria: <ul>
<li>Substrate </li>
<li>Catalytic enzyme(s)</li>
</ul>
</li>
<li>General criteria : <ul>
<li>Organism</li>
<li>Temperature</li>
<li>pH</li>
</ul>
</li>
</ul>
</details>        <p>This function filters out mutant enzyme variants, orders the remaining entries based on enzyme and organism similarity,
and iteratively computes a score for each candidate to identify the best match. If a candidate requires an Arrhenius
adjustment, the kcat value is recalculated accordingly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kcat_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing enzyme information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_output</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing kcat entries and metadata from an API.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>general_criteria</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary specifying matching criteria.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>best_score (float): The lowest score found, representing the best match.
best_candidate (dict or None): Dictionary of the best matching candidate's data, or None if no match is found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/matching.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_best_match</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the best matching enzyme entry from the provided API output based on: </span>
<span class="sd">        - Kcat specific criteria: </span>
<span class="sd">            * Substrate </span>
<span class="sd">            * Catalytic enzyme(s)</span>
<span class="sd">        - General criteria : </span>
<span class="sd">            * Organism</span>
<span class="sd">            * Temperature</span>
<span class="sd">            * pH</span>

<span class="sd">    This function filters out mutant enzyme variants, orders the remaining entries based on enzyme and organism similarity,</span>
<span class="sd">    and iteratively computes a score for each candidate to identify the best match. If a candidate requires an Arrhenius</span>
<span class="sd">    adjustment, the kcat value is recalculated accordingly.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kcat_dict (dict): Dictionary containing enzyme information.</span>
<span class="sd">        api_output (pd.DataFrame): DataFrame containing kcat entries and metadata from an API.</span>
<span class="sd">        general_criteria (dict): Dictionary specifying matching criteria.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:</span>
<span class="sd">            best_score (float): The lowest score found, representing the best match.</span>
<span class="sd">            best_candidate (dict or None): Dictionary of the best matching candidate&#39;s data, or None if no match is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 1. Remove mutant enzymes</span>
    <span class="n">api_output</span> <span class="o">=</span> <span class="n">api_output</span><span class="p">[</span><span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;EnzymeVariant&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;wildtype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">])]</span>
    <span class="k">if</span> <span class="n">api_output</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">14</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># 2. Compute score and adjust kcat if needed</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">adjusted_kcats</span><span class="p">,</span> <span class="n">adjusted_temps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">api_output</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">candidate_dict</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">score</span><span class="p">,</span> <span class="n">arrhenius</span> <span class="o">=</span> <span class="n">compute_score</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">candidate_dict</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arrhenius</span><span class="p">:</span>
            <span class="n">kcat</span> <span class="o">=</span> <span class="n">arrhenius_equation</span><span class="p">(</span><span class="n">candidate_dict</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span>
            <span class="n">candidate_dict</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kcat</span>
            <span class="n">candidate_dict</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">])</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        <span class="n">adjusted_kcats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]))</span>
        <span class="n">adjusted_temps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]))</span>

    <span class="n">api_output</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;adj_kcat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjusted_kcats</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;adj_temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjusted_temps</span>

    <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;adj_kcat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;adj_kcat&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize columns for tie-breaking</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;id_perc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;organism_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="c1"># 3. Keep only best-score candidates</span>
    <span class="n">min_score</span> <span class="o">=</span> <span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">tied</span> <span class="o">=</span> <span class="n">api_output</span><span class="p">[</span><span class="n">api_output</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">min_score</span><span class="p">]</span>

    <span class="c1"># 4. Tie-breaking</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tied</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Tie-break with enzyme identity</span>
        <span class="n">tied</span> <span class="o">=</span> <span class="n">closest_enz</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">tied</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tied</span><span class="p">[</span><span class="s1">&#39;id_perc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">max_id</span> <span class="o">=</span> <span class="n">tied</span><span class="p">[</span><span class="s1">&#39;id_perc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">tied</span> <span class="o">=</span> <span class="n">tied</span><span class="p">[</span><span class="n">tied</span><span class="p">[</span><span class="s1">&#39;id_perc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_id</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tied</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Tie-break with taxonomy</span>
        <span class="n">tied</span> <span class="o">=</span> <span class="n">closest_taxonomy</span><span class="p">(</span><span class="n">general_criteria</span><span class="p">,</span> <span class="n">tied</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tied</span><span class="p">[</span><span class="s1">&#39;organism_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">min_tax</span> <span class="o">=</span> <span class="n">tied</span><span class="p">[</span><span class="s1">&#39;organism_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">tied</span> <span class="o">=</span> <span class="n">tied</span><span class="p">[</span><span class="n">tied</span><span class="p">[</span><span class="s1">&#39;organism_score&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">min_tax</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tied</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Tie-break with max kcat value</span>
        <span class="n">max_kcat</span> <span class="o">=</span> <span class="n">tied</span><span class="p">[</span><span class="s1">&#39;adj_kcat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">tied</span> <span class="o">=</span> <span class="n">tied</span><span class="p">[</span><span class="n">tied</span><span class="p">[</span><span class="s1">&#39;adj_kcat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_kcat</span><span class="p">]</span>

    <span class="c1"># 5. Select best candidate</span>
    <span class="n">best_candidate</span> <span class="o">=</span> <span class="n">tied</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="n">best_candidate</span><span class="p">[</span><span class="s1">&#39;catalytic_enzyme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kcat_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;catalytic_enzyme&#39;</span><span class="p">)</span>
    <span class="n">best_score</span> <span class="o">=</span> <span class="n">best_candidate</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">best_score</span><span class="p">,</span> <span class="n">best_candidate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="find-closest-enzyme-and-organism">Find closest enzyme and organism</h2>


<div class="doc doc-object doc-module">



<h3 id="wildkcat.utils.organism" class="doc doc-heading">
            <code>wildkcat.utils.organism</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.organism.closest_enz" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">closest_enz</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve and ranks the enzymes sequences closest to the sequence of the target enzyme based on the percentage of identity.
If the reference UniProt ID is missing, invalid, or the sequence cannot be retrieved, the function returns the input DataFrame with "id_perc" set to None.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kcat_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing at least the key 'uniprot_model' with the reference UniProt ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_output</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing a column "UniProtKB_AC" with UniProt IDs to compare against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A copy of <code>api_output</code> with an added "id_perc" column (identity percentage).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/organism.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">closest_enz</span><span class="p">(</span><span class="n">kcat_dict</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve and ranks the enzymes sequences closest to the sequence of the target enzyme based on the percentage of identity.</span>
<span class="sd">    If the reference UniProt ID is missing, invalid, or the sequence cannot be retrieved, the function returns the input DataFrame with &quot;id_perc&quot; set to None.</span>

<span class="sd">    Parameters:    </span>
<span class="sd">        kcat_dict (dict): Dictionary containing at least the key &#39;uniprot_model&#39; with the reference UniProt ID.</span>
<span class="sd">        api_output (pd.DataFrame): DataFrame containing a column &quot;UniProtKB_AC&quot; with UniProt IDs to compare against.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A copy of `api_output` with an added &quot;id_perc&quot; column (identity percentage). </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_identity</span><span class="p">(</span><span class="n">seq_ref</span><span class="p">,</span> <span class="n">seq_db</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the percentage of identical characters between two sequences.</span>
<span class="sd">        Adapted from https://gist.github.com/JoaoRodrigues/8c2f7d2fc5ae38fc9cb2 </span>

<span class="sd">        Parameters: </span>
<span class="sd">            seq_ref (str): The reference sequence.</span>
<span class="sd">            seq_db (str): The sequence to compare against.</span>

<span class="sd">        Returns: </span>
<span class="sd">            float: The percentage of identical characters between the two sequences.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">seq_ref</span><span class="p">,</span> <span class="n">seq_db</span><span class="p">)]</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">matches</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq_ref</span><span class="p">)</span>

    <span class="n">ref_uniprot_id</span> <span class="o">=</span> <span class="n">kcat_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;catalytic_enzyme&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">ref_uniprot_id</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;;&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">ref_uniprot_id</span><span class="p">)):</span>
        <span class="n">api_output</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;id_perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">api_output</span>

    <span class="n">ref_seq</span> <span class="o">=</span> <span class="n">convert_uniprot_to_sequence</span><span class="p">(</span><span class="n">ref_uniprot_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ref_seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">api_output</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;id_perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">api_output</span>

    <span class="n">aligner</span> <span class="o">=</span> <span class="n">Align</span><span class="o">.</span><span class="n">PairwiseAligner</span><span class="p">()</span>
    <span class="n">identity_scores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">uniprot_id</span> <span class="ow">in</span> <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;UniProtKB_AC&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">):</span>
            <span class="n">identity_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">convert_uniprot_to_sequence</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">identity_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">identity_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">alignments</span> <span class="o">=</span> <span class="n">aligner</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">ref_seq</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span>
        <span class="n">aligned_ref</span><span class="p">,</span> <span class="n">aligned_db</span> <span class="o">=</span> <span class="n">alignments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">id_score</span> <span class="o">=</span> <span class="n">_calculate_identity</span><span class="p">(</span><span class="n">aligned_ref</span><span class="p">,</span> <span class="n">aligned_db</span><span class="p">)</span>
        <span class="n">identity_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id_score</span><span class="p">)</span>

    <span class="n">api_output</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;id_perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">identity_scores</span>

    <span class="k">return</span> <span class="n">api_output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.organism.closest_taxonomy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">closest_taxonomy</span><span class="p">(</span><span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve and ranks the organisms based on their taxonomic similarity to the reference organism.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>general_criteria</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing at least the key 'organism' with the reference organism.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_output</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing a column "Organism". </p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A copy of <code>api_output</code> with an added "organism_score" column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/organism.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">closest_taxonomy</span><span class="p">(</span><span class="n">general_criteria</span><span class="p">,</span> <span class="n">api_output</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve and ranks the organisms based on their taxonomic similarity to the reference organism.</span>

<span class="sd">    Parameters:    </span>
<span class="sd">        general_criteria (dict): Dictionary containing at least the key &#39;organism&#39; with the reference organism.</span>
<span class="sd">        api_output (pd.DataFrame): DataFrame containing a column &quot;Organism&quot;. </span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A copy of `api_output` with an added &quot;organism_score&quot; column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch_taxonomy</span><span class="p">(</span><span class="n">species_name</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetches the taxonomic lineage for a given species name using NCBI Entrez.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            species_name (str): The name of the species.</span>

<span class="sd">        Returns: </span>
<span class="sd">            list: A list of scientific names representing the taxonomic lineage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Entrez</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;ENTREZ_EMAIL&quot;</span><span class="p">)</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">Entrez</span><span class="o">.</span><span class="n">esearch</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s2">&quot;taxonomy&quot;</span><span class="p">,</span> <span class="n">term</span><span class="o">=</span><span class="n">species_name</span><span class="p">)</span>
        <span class="n">record</span> <span class="o">=</span> <span class="n">Entrez</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;IdList&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="n">tax_id</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;IdList&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">handle</span> <span class="o">=</span> <span class="n">Entrez</span><span class="o">.</span><span class="n">efetch</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="s2">&quot;taxonomy&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">tax_id</span><span class="p">,</span> <span class="n">retmode</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">)</span>
        <span class="n">records</span> <span class="o">=</span> <span class="n">Entrez</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">records</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">lineage</span> <span class="o">=</span> <span class="p">[</span><span class="n">taxon</span><span class="p">[</span><span class="s2">&quot;ScientificName&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;LineageEx&quot;</span><span class="p">]]</span>
        <span class="n">lineage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ScientificName&quot;</span><span class="p">])</span>  <span class="c1"># include the species itself</span>
        <span class="k">return</span> <span class="n">lineage</span>

    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_taxonomy_score</span><span class="p">(</span><span class="n">ref_organism</span><span class="p">,</span> <span class="n">target_organism</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate a taxonomy distance score between reference and target organisms.</span>

<span class="sd">        Parameters: </span>
<span class="sd">            ref_organism (str): The reference organism&#39;s name.</span>
<span class="sd">            target_organism (str): The target organism&#39;s name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: distance between reference and target organisms (0 = identical species, higher = more distant).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ref_lineage</span> <span class="o">=</span> <span class="n">_fetch_taxonomy</span><span class="p">(</span><span class="n">ref_organism</span><span class="p">)</span>
        <span class="n">target_lineage</span> <span class="o">=</span> <span class="n">_fetch_taxonomy</span><span class="p">(</span><span class="n">target_organism</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">target_lineage</span><span class="p">:</span> <span class="c1"># If target organism is not found</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref_lineage</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Penalize missing taxonomy</span>

        <span class="n">similarity</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">target_lineage</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">ref_lineage</span><span class="p">:</span>
                <span class="n">similarity</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref_lineage</span><span class="p">)</span> <span class="o">-</span> <span class="n">similarity</span>


    <span class="n">ref_organism</span> <span class="o">=</span> <span class="n">general_criteria</span><span class="p">[</span><span class="s1">&#39;Organism&#39;</span><span class="p">]</span>
    <span class="n">api_output</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;organism_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">_calculate_taxonomy_score</span><span class="p">(</span><span class="n">ref_organism</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;Organism&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">api_output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="correct-the-kcat-value-using-arrhenius-equation">Correct the kcat value using Arrhenius equation</h2>


<div class="doc doc-object doc-module">



<h3 id="wildkcat.utils.temperature" class="doc doc-heading">
            <code>wildkcat.utils.temperature</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.temperature.arrhenius_equation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">arrhenius_equation</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Estimates the kcat value at a target temperature using the Arrhenius equation, based on available experimental data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>candidate</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Information about the enzyme candidate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>api_output</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing experimental kcat values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>general_criteria</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary specifying selection criteria, including 'Temperature' and 'pH'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated kcat value at the objective temperature, calculated using the Arrhenius equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/temperature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">arrhenius_equation</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">api_output</span><span class="p">,</span> <span class="n">general_criteria</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimates the kcat value at a target temperature using the Arrhenius equation, based on available experimental data.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        candidate (dict): Information about the enzyme candidate.</span>
<span class="sd">        api_output (pd.DataFrame): DataFrame containing experimental kcat values.</span>
<span class="sd">        general_criteria (dict): Dictionary specifying selection criteria, including &#39;Temperature&#39; and &#39;pH&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Estimated kcat value at the objective temperature, calculated using the Arrhenius equation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_kcat</span><span class="p">(</span><span class="n">temp_obj</span><span class="p">,</span> <span class="n">ea</span><span class="p">,</span> <span class="n">kcat_ref</span><span class="p">,</span> <span class="n">temp_ref</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the catalytic rate constant (kcat) at a given temperature using the Arrhenius equation.</span>

<span class="sd">        Parameters: </span>
<span class="sd">            temp_obj (float): The target temperature (in Kelvin) at which to calculate kcat.</span>
<span class="sd">            ea (float): The activation energy calculated using find_ea(). </span>
<span class="sd">            kcat_ref (float): The reference kcat value measured at temp_ref.</span>
<span class="sd">            temp_ref (float): The reference temperature (in Kelvin) at which kcat_ref was measured.</span>

<span class="sd">        Returns: </span>
<span class="sd">            float: The calculated kcat value at temp_obj.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">8.314</span>
        <span class="n">kcat_obj</span> <span class="o">=</span> <span class="n">kcat_ref</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ea</span> <span class="o">/</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">temp_ref</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">temp_obj</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">kcat_obj</span>

    <span class="c1"># Objective temperature</span>
    <span class="n">obj_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">273.15</span>

    <span class="c1"># Format the api_output DataFrame</span>
    <span class="n">ph_min</span><span class="p">,</span> <span class="n">ph_max</span> <span class="o">=</span> <span class="n">general_criteria</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;UniProtKB_AC&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">candidate</span><span class="p">[</span><span class="s2">&quot;UniProtKB_AC&quot;</span><span class="p">])</span> <span class="o">&amp;</span>
        <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span>
        <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span>
        <span class="n">api_output</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">ph_min</span><span class="p">,</span> <span class="n">ph_max</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">api_filtered</span> <span class="o">=</span> <span class="n">api_output</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">filters</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Convert temperatures to Kelvin</span>
    <span class="n">api_filtered</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_filtered</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">273.15</span>

    <span class="c1"># Estimate the activation energy (Ea)</span>
    <span class="n">ea</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calculate_ea</span><span class="p">(</span><span class="n">api_filtered</span><span class="p">)</span>

    <span class="c1"># Select one kcat for the ref</span>
    <span class="n">kcat_ref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">api_filtered</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">temp_ref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">api_filtered</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">kcat</span> <span class="o">=</span> <span class="n">calculate_kcat</span><span class="p">(</span><span class="n">obj_temp</span><span class="p">,</span> <span class="n">ea</span><span class="p">,</span> <span class="n">kcat_ref</span><span class="p">,</span> <span class="n">temp_ref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kcat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.temperature.calculate_ea" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_ea</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Estimate the activation energy (Ea) using the Arrhenius equation from kcat values at different temperatures.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with at least 'Temperature' (C) and 'value' (kcat) columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated activation energy (Ea) in J/mol.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/temperature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_ea</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate the activation energy (Ea) using the Arrhenius equation from kcat values at different temperatures.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (pd.DataFrame): DataFrame with at least &#39;Temperature&#39; (C) and &#39;value&#39; (kcat) columns.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Estimated activation energy (Ea) in J/mol. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="mf">8.314</span>  <span class="c1"># Gas constant in J/(mol*K)</span>

    <span class="c1"># Filter out rows with missing values</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="n">temps_K</span> <span class="o">=</span> <span class="n">valid</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">kcats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">valid</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">temps_K</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kcats</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># R2 </span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="n">ss_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ss_res</span> <span class="o">/</span> <span class="n">ss_tot</span> <span class="k">if</span> <span class="n">ss_tot</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Activation energy </span>
    <span class="n">ea</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="o">-</span><span class="n">slope</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ea</span><span class="p">,</span> <span class="n">r2</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="api">API</h2>


<div class="doc doc-object doc-module">



<h3 id="wildkcat.api.brenda_api" class="doc doc-heading">
            <code>wildkcat.api.brenda_api</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.brenda_api.create_brenda_client" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_brenda_client</span><span class="p">(</span><span class="n">wsdl_url</span><span class="o">=</span><span class="s1">&#39;https://www.brenda-enzymes.org/soap/brenda_zeep.wsdl&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creates and configures a persistent SOAP client for the BRENDA API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>wsdl_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL to the BRENDA WSDL file.</p>
              </div>
            </td>
            <td>
                  <code>&#39;https://www.brenda-enzymes.org/soap/brenda_zeep.wsdl&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="zeep.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>zeep.Client: Configured SOAP client.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/brenda_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_brenda_client</span><span class="p">(</span><span class="n">wsdl_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://www.brenda-enzymes.org/soap/brenda_zeep.wsdl&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Client</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates and configures a persistent SOAP client for the BRENDA API.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        wsdl_url (str): URL to the BRENDA WSDL file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        zeep.Client: Configured SOAP client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Configure retry logic for network resilience</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
    <span class="n">retry</span> <span class="o">=</span> <span class="n">Retry</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">status_forcelist</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">])</span>
    <span class="n">adapter</span> <span class="o">=</span> <span class="n">HTTPAdapter</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">retry</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>

    <span class="c1"># Set a custom User-Agent (some servers block default Python UA)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;BRENDA-Client&quot;</span><span class="p">})</span>

    <span class="c1"># Create zeep transport and settings</span>
    <span class="n">transport</span> <span class="o">=</span> <span class="n">Transport</span><span class="p">(</span><span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">InMemoryCache</span><span class="p">())</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xml_huge_tree</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">Client</span><span class="p">(</span><span class="n">wsdl_url</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span> <span class="n">transport</span><span class="o">=</span><span class="n">transport</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.brenda_api.get_brenda_credentials" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_brenda_credentials</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieves and hashes BRENDA API credentials from environment variables.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[str, str]: (email, hashed_password)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/brenda_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_brenda_credentials</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves and hashes BRENDA API credentials from environment variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str, str]: (email, hashed_password)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;BRENDA_EMAIL&quot;</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;BRENDA_PASSWORD&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">email</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;BRENDA_EMAIL and BRENDA_PASSWORD environment variables must be set.&quot;</span><span class="p">)</span>

    <span class="n">hashed_password</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">email</span><span class="p">,</span> <span class="n">hashed_password</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.brenda_api.get_cofactor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cofactor</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Queries the BRENDA SOAP API to retrieve cofactor information for a given Enzyme Commission (EC) number.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ec_number</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EC number (e.g., '1.1.1.1').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A DataFrame containing turnover number entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/brenda_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_cofactor</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Queries the BRENDA SOAP API to retrieve cofactor information for a given Enzyme Commission (EC) number.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ec_number (str): EC number (e.g., &#39;1.1.1.1&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing turnover number entries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Call the SOAP API</span>
    <span class="n">email</span><span class="p">,</span> <span class="n">hashed_password</span> <span class="o">=</span> <span class="n">get_brenda_credentials</span><span class="p">()</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">create_brenda_client</span><span class="p">()</span>

    <span class="n">parameters_cofactor</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">email</span><span class="p">,</span>
        <span class="n">hashed_password</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;ecNumber*</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s2">&quot;cofactor*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;commentary*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;organism*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;ligandStructureId*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;literature*&quot;</span>
    <span class="p">]</span>

    <span class="n">result_cofactor</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">getCofactor</span><span class="p">(</span><span class="o">*</span><span class="n">parameters_cofactor</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">serialize_object</span><span class="p">(</span><span class="n">result_cofactor</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="n">cofactor</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cofactor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cofactor</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.brenda_api.get_turnover_number_brenda" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_turnover_number_brenda</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Queries the BRENDA SOAP API to retrieve turnover number values for a Enzyme Commission (EC) Number.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ec_number</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EC number (e.g., '1.1.1.1').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: A DataFrame containing turnover number entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/brenda_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_turnover_number_brenda</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Queries the BRENDA SOAP API to retrieve turnover number values for a Enzyme Commission (EC) Number.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ec_number (str): EC number (e.g., &#39;1.1.1.1&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing turnover number entries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">email</span><span class="p">,</span> <span class="n">hashed_password</span> <span class="o">=</span> <span class="n">get_brenda_credentials</span><span class="p">()</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">create_brenda_client</span><span class="p">()</span>

    <span class="c1"># Define the parameters for the SOAP request</span>

    <span class="n">parameters_kcat</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">email</span><span class="p">,</span>
        <span class="n">hashed_password</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;ecNumber*</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s2">&quot;turnoverNumber*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;turnoverNumberMaximum*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;substrate*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;commentary*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;organism*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;ligandStructureId*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;literature*&quot;</span>
    <span class="p">]</span>

    <span class="n">parameters_org</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">email</span><span class="p">,</span>
        <span class="n">hashed_password</span><span class="p">,</span>
        <span class="sa">f</span><span class="s1">&#39;ecNumber*</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="s2">&quot;organism*&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sequenceCode*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;commentary*&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;literature*&quot;</span><span class="p">,</span>
        <span class="s2">&quot;textmining*&quot;</span>
    <span class="p">]</span>

    <span class="c1"># print(client.service.__getattr__(&#39;getTurnoverNumber&#39;).__doc__)</span>
    <span class="c1"># print(client.service.__getattr__(&#39;getOrganism&#39;).__doc__)</span>

    <span class="n">result_kcat</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">getTurnoverNumber</span><span class="p">(</span><span class="o">*</span><span class="n">parameters_kcat</span><span class="p">)</span>
    <span class="n">result_organism</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">getOrganism</span><span class="p">(</span><span class="o">*</span><span class="n">parameters_org</span><span class="p">)</span>

    <span class="c1"># Format the response into a DataFrame</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">serialize_object</span><span class="p">(</span><span class="n">result_kcat</span><span class="p">)</span>
    <span class="n">data_organism</span> <span class="o">=</span> <span class="n">serialize_object</span><span class="p">(</span><span class="n">result_organism</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: No data found for the query in BRENDA.&#39;</span> <span class="o">%</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># Remove None values (-999)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;turnoverNumber&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;turnoverNumber&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;-999&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: No valid data found for the query in BRENDA.&#39;</span> <span class="o">%</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">df_org</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_organism</span><span class="p">)</span>

    <span class="c1"># Format the organism response</span>
    <span class="n">df_org</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;commentary&#39;</span><span class="p">,</span> <span class="s1">&#39;textmining&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="c1"># Merge on the literature column</span>
    <span class="n">df_org</span><span class="p">[</span><span class="s1">&#39;literature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_org</span><span class="p">[</span><span class="s1">&#39;literature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;literature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;literature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_org</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;literature&#39;</span><span class="p">,</span> <span class="s1">&#39;organism&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Rename columns for consistency with other APIs</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;turnoverNumber&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sequenceCode&#39;</span> <span class="p">:</span> <span class="s1">&#39;UniProtKB_AC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;substrate&#39;</span><span class="p">:</span> <span class="s1">&#39;Substrate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;organism&#39;</span><span class="p">:</span> <span class="s1">&#39;Organism&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ecNumber&#39;</span><span class="p">:</span> <span class="s1">&#39;ECNumber&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

    <span class="c1"># Extract pH from commentary</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;commentary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;pH\s*([\d\.]+)&quot;</span><span class="p">)</span>
    <span class="c1"># Extract temperature from commentary</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;commentary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([\d\.]+)\?C&quot;</span><span class="p">)</span>
    <span class="c1"># Convert Temperature and pH to numeric, coercing errors to NaN</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pH&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="c1"># Extract enzyme variant from commentary</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;EnzymeVariant&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;commentary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_variant</span><span class="p">)</span>
    <span class="c1"># Drop unnecessary columns</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;literature&quot;</span><span class="p">,</span> <span class="s2">&quot;turnoverNumberMaximum&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter.endValue&quot;</span><span class="p">,</span> <span class="s2">&quot;commentary&quot;</span><span class="p">,</span> <span class="s2">&quot;ligandStructureId&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="c1"># Remove the cofactor from the output </span>
    <span class="n">cofactor</span> <span class="o">=</span> <span class="n">get_cofactor</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span>
    <span class="c1"># Drop the lines where the cofactor is not define</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Substrate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cofactor</span><span class="p">)]</span>   
    <span class="c1"># Drop duplicates</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Add a column for the db </span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;brenda&#39;</span> 
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.brenda_api.get_variant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_variant</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Extracts the enzyme variant information from the commentary text.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Commentary text from BRENDA API response.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The extracted enzyme variant information: wildtype, mutant, or None if not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/brenda_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_variant</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the enzyme variant information from the commentary text.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        text (str): Commentary text from BRENDA API response.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The extracted enzyme variant information: wildtype, mutant, or None if not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;wild&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>  <span class="c1"># wild-type, wildtype or wild type</span>
        <span class="k">return</span> <span class="s2">&quot;wildtype&quot;</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">word</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mutant&quot;</span><span class="p">,</span> <span class="s2">&quot;mutated&quot;</span><span class="p">,</span> <span class="s2">&quot;mutation&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s2">&quot;mutant&quot;</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="wildkcat.api.sabio_rk_api" class="doc doc-heading">
            <code>wildkcat.api.sabio_rk_api</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.sabio_rk_api.get_turnover_number_sabio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_turnover_number_sabio</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve turnover number (kcat) data from SABIO-RK for a given EC number.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ec_number</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enzyme Commission number.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: DataFrame containing SABIO-RK entries for kcat.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/sabio_rk_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_turnover_number_sabio</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve turnover number (kcat) data from SABIO-RK for a given EC number.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        ec_number (str): Enzyme Commission number.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame containing SABIO-RK entries for kcat.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://sabiork.h-its.org/sabioRestWebServices/searchKineticLaws/entryIDs&#39;</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="s1">&#39;https://sabiork.h-its.org/entry/exportToExcelCustomizable&#39;</span>
    <span class="n">entryIDs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># -- Retrieve entryIDs --</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Parametertype:&quot;kcat&quot; AND ECNumber:&quot;</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">}</span>

    <span class="c1"># Make GET request</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;no data found&quot;</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: No data found for the query in SABIO-RK.&#39;</span> <span class="o">%</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ec_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>  <span class="c1"># Return empty DataFrame if no data found</span>

    <span class="n">entryIDs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]</span>
    <span class="c1"># Retrieve informations matching the entryIDs</span>
    <span class="n">data_field</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;entryIDs[]&#39;</span><span class="p">:</span> <span class="n">entryIDs</span><span class="p">}</span>
    <span class="c1"># Possible fields to retrieve:</span>
    <span class="c1"># EntryID, Reaction, Buffer, ECNumber, CellularLocation, UniProtKB_AC, Tissue, Enzyme Variant, Enzymename, Organism</span>
    <span class="c1"># Temperature, pH, Activator, Cofactor, Inhibitor, KeggReactionID, KineticMechanismType, Other Modifier, Parameter,</span>
    <span class="c1"># Pathway, Product, PubMedID, Publication, Rate Equation, SabioReactionID, Substrate</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;format&#39;</span><span class="p">:</span><span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;fields[]&#39;</span><span class="p">:[</span><span class="s1">&#39;EntryID&#39;</span><span class="p">,</span> <span class="s1">&#39;ECNumber&#39;</span><span class="p">,</span> <span class="s1">&#39;KeggReactionID&#39;</span><span class="p">,</span> <span class="s1">&#39;Reaction&#39;</span><span class="p">,</span> <span class="s1">&#39;Substrate&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> 
                                         <span class="s1">&#39;UniProtKB_AC&#39;</span><span class="p">,</span> <span class="s1">&#39;Organism&#39;</span><span class="p">,</span> <span class="s1">&#39;Enzyme Variant&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;pH&#39;</span><span class="p">,</span> 
                                         <span class="s1">&#39;Parameter&#39;</span><span class="p">]}</span>

    <span class="c1"># Make POST request</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_field</span><span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

    <span class="c1"># Format the response into a DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;parameter.name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;kcat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Keep only kcat parameters</span>
    <span class="c1"># Convert Temperature and pH to numeric, coercing errors to NaN</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pH&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="c1"># Drop unnecessary columns</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EntryID&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter.name&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter.type&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter.associatedSpecies&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;parameter.endValue&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter.standardDeviation&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="c1"># Drop duplicates based on normalized Substrate and Product sets</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Substrate_set&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Substrate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">())))</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product_set&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">())))</span>
    <span class="n">dedup_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;Product&quot;</span><span class="p">]]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">dedup_cols</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Substrate_set&quot;</span><span class="p">,</span> <span class="s2">&quot;Product_set&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Substrate_set&quot;</span><span class="p">,</span> <span class="s2">&quot;Product_set&quot;</span><span class="p">])</span>
    <span class="c1"># Rename columns for consistency</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;ECNumber&#39;</span><span class="p">:</span> <span class="s1">&#39;ECNumber&#39;</span><span class="p">,</span>
        <span class="s1">&#39;KeggReactionID&#39;</span><span class="p">:</span> <span class="s1">&#39;KeggReactionID&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Reaction&#39;</span><span class="p">:</span> <span class="s1">&#39;Reaction&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Substrate&#39;</span><span class="p">:</span> <span class="s1">&#39;Substrate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Product&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span>
        <span class="s1">&#39;UniProtKB_AC&#39;</span><span class="p">:</span> <span class="s1">&#39;UniProtKB_AC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Organism&#39;</span><span class="p">:</span> <span class="s1">&#39;Organism&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Enzyme Variant&#39;</span><span class="p">:</span> <span class="s1">&#39;EnzymeVariant&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Temperature&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pH&#39;</span><span class="p">:</span> <span class="s1">&#39;pH&#39;</span><span class="p">,</span>
        <span class="s1">&#39;parameter.startValue&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span>
        <span class="s1">&#39;parameter.unit&#39;</span><span class="p">:</span> <span class="s1">&#39;unit&#39;</span>
    <span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Add a column for the db</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sabio_rk&#39;</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="wildkcat.api.uniprot_api" class="doc doc-heading">
            <code>wildkcat.api.uniprot_api</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.uniprot_api.catalytic_activity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">catalytic_activity</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieves the EC (Enzyme Commission) numbers associated with the catalytic activity of a given UniProt ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>uniprot_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UniProt identifier for the protein of interest.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str] or None: A list of EC numbers if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/uniprot_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">catalytic_activity</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the EC (Enzyme Commission) numbers associated with the catalytic activity of a given UniProt ID.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        uniprot_id (str): The UniProt identifier for the protein of interest.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str] or None: A list of EC numbers if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://rest.uniprot.org/uniprotkb/</span><span class="si">{</span><span class="n">uniprot_id</span><span class="si">}</span><span class="s2">?fields=cc_catalytic_activity&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="n">ec_numbers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;comments&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="k">if</span> <span class="n">comment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;commentType&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CATALYTIC ACTIVITY&#39;</span><span class="p">:</span>
                <span class="n">reaction</span> <span class="o">=</span> <span class="n">comment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reaction&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="n">ec_number</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ecNumber&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ec_number</span><span class="p">:</span>
                    <span class="n">ec_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ec_number</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ec_numbers</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ec_numbers</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># logging.warning(f&quot;No catalytic activity found for UniProt ID {uniprot_id}&quot;)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.uniprot_api.convert_uniprot_to_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_uniprot_to_sequence</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Convert a UniProt accession ID to its corresponding amino acid sequence.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>uniprot_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UniProt accession ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The amino acid sequence, or None if not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/uniprot_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_uniprot_to_sequence</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a UniProt accession ID to its corresponding amino acid sequence.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        uniprot_id (str): The UniProt accession ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The amino acid sequence, or None if not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://rest.uniprot.org/uniprotkb/</span><span class="si">{</span><span class="n">uniprot_id</span><span class="si">}</span><span class="s2">.fasta&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">fasta</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">fasta</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># Skip the header</span>
        <span class="k">return</span> <span class="n">sequence</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># logging.warning(f&quot;Failed to retrieve sequence for UniProt ID {uniprot_id}&quot;)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.api.uniprot_api.identify_catalytic_enzyme" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identify_catalytic_enzyme</span><span class="p">(</span><span class="n">lst_uniprot_ids</span><span class="p">,</span> <span class="n">ec</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Identifies the catalytic enzyme from a list of UniProt IDs for a given EC number.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lst_uniprot_ids</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A semicolon-separated string of UniProt IDs representing enzyme candidates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ec</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Enzyme Commission (EC) number to match against the catalytic activity.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str or None: The UniProt ID of the catalytic enzyme if exactly one match is found; 
         None if no match or multiple matches are found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/api/uniprot_api.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">identify_catalytic_enzyme</span><span class="p">(</span><span class="n">lst_uniprot_ids</span><span class="p">,</span> <span class="n">ec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identifies the catalytic enzyme from a list of UniProt IDs for a given EC number.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        lst_uniprot_ids (str): A semicolon-separated string of UniProt IDs representing enzyme candidates.</span>
<span class="sd">        ec (str): The Enzyme Commission (EC) number to match against the catalytic activity.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str or None: The UniProt ID of the catalytic enzyme if exactly one match is found; </span>
<span class="sd">                     None if no match or multiple matches are found.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">enzymes_model</span> <span class="o">=</span> <span class="n">lst_uniprot_ids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">catalytic_enzyme</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">enzyme</span> <span class="ow">in</span> <span class="n">enzymes_model</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">catalytic_activity</span><span class="p">(</span><span class="n">enzyme</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ec</span> <span class="ow">in</span> <span class="n">catalytic_activity</span><span class="p">(</span><span class="n">enzyme</span><span class="p">):</span>
                <span class="n">catalytic_enzyme</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">catalytic_enzyme</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ec</span><span class="si">}</span><span class="s2">: No catalytic enzyme found for the complex </span><span class="si">{</span><span class="n">lst_uniprot_ids</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">catalytic_enzyme</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">catalytic_enzyme</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ec</span><span class="si">}</span><span class="s2">: Multiple catalytic enzymes found for the complex </span><span class="si">{</span><span class="n">lst_uniprot_ids</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">catalytic_enzyme</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">catalytic_enzyme</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">catalytic_enzyme</span> <span class="o">=</span> <span class="n">catalytic_enzyme</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">catalytic_enzyme</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="machine-learning-preprocessing">Machine Learning preprocessing</h2>


<div class="doc doc-object doc-module">



<h3 id="wildkcat.machine_learning.catapro" class="doc doc-heading">
            <code>wildkcat.machine_learning.catapro</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.machine_learning.catapro.convert_cid_to_smiles" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_cid_to_smiles</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Converts a PubChem Compound ID (CID) to its corresponding SMILES representation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PubChem Compound ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list or None: A list of SMILES strings if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/machine_learning/catapro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_cid_to_smiles</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>    
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a PubChem Compound ID (CID) to its corresponding SMILES representation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cid (str): PubChem Compound ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">       list or None: A list of SMILES strings if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{</span><span class="n">cid</span><span class="si">}</span><span class="s2">/property/smiles/txt&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">safe_get_with_retry</span> <span class="o">=</span> <span class="n">retry_api</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">safe_requests_get</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">safe_get_with_retry</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">smiles</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.machine_learning.catapro.convert_kegg_compound_to_sid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_kegg_compound_to_sid</span><span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert the KEGG compound ID to the PubChem Substance ID (SID).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kegg_compound_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>KEGG compound ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PubChem SID if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/machine_learning/catapro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_kegg_compound_to_sid</span><span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the KEGG compound ID to the PubChem Substance ID (SID).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kegg_compound_id (str): KEGG compound ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The PubChem SID if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://rest.kegg.jp/conv/pubchem/compound:</span><span class="si">{</span><span class="n">kegg_compound_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">safe_get_with_retry</span> <span class="o">=</span> <span class="n">retry_api</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">safe_requests_get</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">safe_get_with_retry</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;pubchem:\s*(\d+)&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">sid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.machine_learning.catapro.convert_kegg_to_smiles" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_kegg_to_smiles</span><span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Convert the KEGG compound ID to the PubChem Compound ID (CID).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kegg_compound_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>KEGG compound ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list or None: A list of SMILES strings if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/machine_learning/catapro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_kegg_to_smiles</span><span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the KEGG compound ID to the PubChem Compound ID (CID).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kegg_compound_id (str): KEGG compound ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list or None: A list of SMILES strings if found, otherwise None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="n">convert_kegg_compound_to_sid</span><span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: Failed to retrieve SID for KEGG compound ID&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">cid</span> <span class="o">=</span> <span class="n">convert_sid_to_cid</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: Failed to retrieve CID for KEGG compound ID&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">convert_cid_to_smiles</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">smiles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: Failed to retrieve SMILES for KEGG compound ID&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.machine_learning.catapro.convert_sid_to_cid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_sid_to_cid</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Converts a PubChem Substance ID (SID) to the corresponding Compound ID (CID).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PubChem Substance ID.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int or None: The corresponding PubChem Compound ID (CID), or None if not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/machine_learning/catapro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_sid_to_cid</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a PubChem Substance ID (SID) to the corresponding Compound ID (CID).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        sid (str): PubChem Substance ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int or None: The corresponding PubChem Compound ID (CID), or None if not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://pubchem.ncbi.nlm.nih.gov/rest/pug/substance/sid/</span><span class="si">{</span><span class="n">sid</span><span class="si">}</span><span class="s2">/cids/JSON&quot;</span>
    <span class="n">safe_get_with_retry</span> <span class="o">=</span> <span class="n">retry_api</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">safe_requests_get</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">safe_get_with_retry</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cid</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;InformationList&#39;</span><span class="p">][</span><span class="s1">&#39;Information&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;CID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">cid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">cid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.machine_learning.catapro.create_catapro_input_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_catapro_input_file</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate CataPro input file and a mapping of substrate KEGG IDs to SMILES.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kcat_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DataFrame containing kcat information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>catapro_input_df</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame for CataPro input.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>substrates_to_smiles</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping KEGG ID &lt;-&gt; SMILES.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/machine_learning/catapro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_catapro_input_file</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate CataPro input file and a mapping of substrate KEGG IDs to SMILES.</span>

<span class="sd">    Parameters: </span>
<span class="sd">        kcat_df (pd.DataFrame): Input DataFrame containing kcat information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        catapro_input_df (pd.DataFrame): DataFrame for CataPro input.</span>
<span class="sd">        substrates_to_smiles (dict): Mapping KEGG ID &lt;-&gt; SMILES.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catapro_input</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">substrates_to_smiles</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">counter_no_catalytic</span><span class="p">,</span> <span class="n">counter_kegg_no_matching</span><span class="p">,</span> <span class="n">counter_rxn_covered</span><span class="p">,</span> <span class="n">counter_cofactor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">kcat_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating CataPro input&quot;</span><span class="p">):</span>
        <span class="n">uniprot</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;uniprot&#39;</span><span class="p">]</span>
        <span class="n">ec_code</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ec_code&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uniprot</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>       
            <span class="n">catalytic_enzyme</span> <span class="o">=</span> <span class="n">identify_catalytic_enzyme</span><span class="p">(</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">ec_code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">catalytic_enzyme</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;;&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalytic_enzyme</span><span class="p">)):</span>
                <span class="n">counter_no_catalytic</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">uniprot</span> <span class="o">=</span> <span class="n">catalytic_enzyme</span>

        <span class="c1"># If the number of KEGG Compound IDs is not matching the number of names, continue </span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;substrates_kegg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;substrates_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of KEGG compounds IDs does not match number of names for </span><span class="si">{</span><span class="n">ec_code</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">uniprot</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">counter_kegg_no_matching</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="n">sequence</span> <span class="o">=</span> <span class="n">convert_uniprot_to_sequence</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">smiles_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;substrates_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
        <span class="n">kegg_ids</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;substrates_kegg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

        <span class="c1"># Get the cofactor for the EC code</span>
        <span class="n">cofactor</span> <span class="o">=</span> <span class="n">get_cofactor</span><span class="p">(</span><span class="n">ec_code</span><span class="p">)</span> 

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">kegg_compound_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">kegg_ids</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cofactor</span><span class="p">]:</span>  <span class="c1"># TODO: Should we add a warning if no cofactor is found for a reaction? </span>
                <span class="n">counter_cofactor</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">convert_kegg_to_smiles</span><span class="p">(</span><span class="n">kegg_compound_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">smiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">smiles_str</span> <span class="o">=</span> <span class="n">smiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># TODO: If multiple SMILES, take the first one ? </span>
                <span class="n">smiles_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">smiles_str</span><span class="p">)</span>
                <span class="n">substrates_to_smiles</span><span class="p">[</span><span class="n">kegg_compound_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">smiles_str</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">smiles_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">smiles</span> <span class="ow">in</span> <span class="n">smiles_list</span><span class="p">:</span>
                <span class="n">catapro_input</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;Enzyme_id&quot;</span><span class="p">:</span> <span class="n">uniprot</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;wild&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sequence&quot;</span><span class="p">:</span> <span class="n">sequence</span><span class="p">,</span>
                    <span class="s2">&quot;smiles&quot;</span><span class="p">:</span> <span class="n">smiles</span>
                <span class="p">})</span>

        <span class="n">counter_rxn_covered</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Generate CataPro input file</span>
    <span class="n">catapro_input_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">catapro_input</span><span class="p">)</span>
    <span class="c1"># Remove duplicates</span>
    <span class="n">before_duplicates_filter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">catapro_input_df</span><span class="p">)</span>
    <span class="n">catapro_input_df</span> <span class="o">=</span> <span class="n">catapro_input_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">nb_lines_dropped</span> <span class="o">=</span> <span class="n">before_duplicates_filter</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">catapro_input_df</span><span class="p">)</span>
    <span class="c1"># Generate reverse mapping from SMILES to KEGG IDs as TSV</span>
    <span class="n">substrates_to_smiles_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">substrates_to_smiles</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kegg_id&#39;</span><span class="p">,</span> <span class="s1">&#39;smiles&#39;</span><span class="p">])</span>

    <span class="n">report_statistics</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;rxn_covered&quot;</span><span class="p">:</span> <span class="n">counter_rxn_covered</span><span class="p">,</span>
        <span class="s2">&quot;cofactor_identified&quot;</span><span class="p">:</span> <span class="n">counter_cofactor</span><span class="p">,</span>
        <span class="s2">&quot;no_catalytic&quot;</span><span class="p">:</span> <span class="n">counter_no_catalytic</span><span class="p">,</span>
        <span class="s2">&quot;kegg_no_matching&quot;</span><span class="p">:</span> <span class="n">counter_kegg_no_matching</span><span class="p">,</span>
        <span class="s2">&quot;duplicates_enzyme_substrates&quot;</span><span class="p">:</span> <span class="n">nb_lines_dropped</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">catapro_input_df</span><span class="p">,</span> <span class="n">substrates_to_smiles_df</span><span class="p">,</span> <span class="n">report_statistics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.machine_learning.catapro.integrate_catapro_predictions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">integrate_catapro_predictions</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">,</span> <span class="n">substrates_to_smiles</span><span class="p">,</span> <span class="n">catapro_predictions_df</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Integrates Catapro predictions into an kcat file.
If multiple values are provided for a single combination of EC, Enzyme, Substrate, the minimum value is taken.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kcat_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DataFrame containing kcat information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>substrates_to_smiles</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame mapping KEGG ID &lt;-&gt; SMILES.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catapro_predictions_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing Catapro model predictions</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The input kcat_df with an additional column 'catapro_predicted_kcat_s' containing
the integrated Catapro predicted kcat(s^-1) values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/machine_learning/catapro.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">integrate_catapro_predictions</span><span class="p">(</span><span class="n">kcat_df</span><span class="p">,</span> <span class="n">substrates_to_smiles</span><span class="p">,</span> <span class="n">catapro_predictions_df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrates Catapro predictions into an kcat file.</span>
<span class="sd">    If multiple values are provided for a single combination of EC, Enzyme, Substrate, the minimum value is taken.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        kcat_df (pd.DataFrame): Input DataFrame containing kcat information.</span>
<span class="sd">        substrates_to_smiles (pd.DataFrame): DataFrame mapping KEGG ID &lt;-&gt; SMILES.</span>
<span class="sd">        catapro_predictions_df (pd.DataFrame): DataFrame containing Catapro model predictions</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The input kcat_df with an additional column &#39;catapro_predicted_kcat_s&#39; containing</span>
<span class="sd">            the integrated Catapro predicted kcat(s^-1) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert pred_log10[kcat(s^-1)] to kcat(s^-1)</span>
    <span class="n">catapro_predictions_df</span><span class="p">[</span><span class="s1">&#39;kcat_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">catapro_predictions_df</span><span class="p">[</span><span class="s1">&#39;pred_log10[kcat(s^-1)]&#39;</span><span class="p">]</span>
    <span class="n">catapro_predictions_df</span><span class="p">[</span><span class="s1">&#39;uniprot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">catapro_predictions_df</span><span class="p">[</span><span class="s1">&#39;fasta_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_wild&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Extract UniProt ID</span>

    <span class="c1"># Match the SMILES to KEGG IDs using substrates_to_smiles</span>
    <span class="c1"># If multiple KEGG IDs are found for a single SMILES, they are concatenated</span>
    <span class="n">smiles_to_kegg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">substrates_to_smiles</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;smiles&#39;</span><span class="p">)[</span><span class="s1">&#39;kegg_id&#39;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
    <span class="p">)</span>
    <span class="n">catapro_predictions_df</span><span class="p">[</span><span class="s1">&#39;substrates_kegg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">catapro_predictions_df</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">smiles_to_kegg</span><span class="p">)</span>

    <span class="n">catapro_map</span> <span class="o">=</span> <span class="n">catapro_predictions_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;substrates_kegg&#39;</span><span class="p">])[</span><span class="s1">&#39;kcat_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_min_pred_kcat</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">uniprot</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;uniprot&#39;</span><span class="p">]</span>
        <span class="n">kegg_ids</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;substrates_kegg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
        <span class="n">kcat_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">catapro_map</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">kegg_id</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">kegg_id</span> <span class="ow">in</span> <span class="n">kegg_ids</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">kegg_id</span><span class="p">)</span> <span class="ow">in</span> <span class="n">catapro_map</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">kcat_values</span><span class="p">)</span> <span class="k">if</span> <span class="n">kcat_values</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># If multiple substrates, take the minimum kcat value</span>

    <span class="n">kcat_df</span><span class="p">[</span><span class="s1">&#39;catapro_predicted_kcat_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kcat_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_min_pred_kcat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kcat_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="generate-reports">Generate reports</h2>


<div class="doc doc-object doc-module">



<h3 id="wildkcat.utils.generate_reports" class="doc doc-heading">
            <code>wildkcat.utils.generate_reports</code>


</h3>

    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_extraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_extraction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">report_statistics</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a detailed HTML report summarizing kcat extraction results from a metabolic model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metabolic model object containing reactions, metabolites, and genes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing data from the run_extraction function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>report_statistics</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with statistics about EC code assignment and extraction issues.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the report will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shader</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, includes a shader canvas background in the report. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function saves the generated HTML report to 'reports/extract_kcat_report.html'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_extraction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">report_statistics</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a detailed HTML report summarizing kcat extraction results from a metabolic model.</span>

<span class="sd">    Parameters: </span>
<span class="sd">        model (cobra.Model): The metabolic model object containing reactions, metabolites, and genes.</span>
<span class="sd">        df (pandas.DataFrame): DataFrame containing data from the run_extraction function.</span>
<span class="sd">        report_statistics (dict): Dictionary with statistics about EC code assignment and extraction issues.</span>
<span class="sd">        output_folder (str): Path to the output folder where the report will be saved.</span>
<span class="sd">        shader (bool, optional): If True, includes a shader canvas background in the report. Default is False.</span>

<span class="sd">    Returns: </span>
<span class="sd">        None: The function saves the generated HTML report to &#39;reports/extract_kcat_report.html&#39;. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model statistics</span>
    <span class="n">nb_model_reactions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span>
    <span class="n">nb_model_metabolites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span>
    <span class="n">nb_model_genes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">genes</span><span class="p">)</span>
    <span class="n">unique_ec_codes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">ec_code</span> <span class="o">=</span> <span class="n">rxn</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ec-code&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ec_code</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ec_code</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">ec_code</span> <span class="o">=</span> <span class="p">[</span><span class="n">ec_code</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ec_code</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">ec_code</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ec_code</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ec_code</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">unique_ec_codes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ec_code</span><span class="p">)</span>
    <span class="n">nb_model_ec_codes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">unique_ec_codes</span><span class="p">))</span>

    <span class="c1"># Kcat statistics</span>
    <span class="n">nb_reactions</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;rxn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    <span class="n">nb_ec_codes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ec_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

    <span class="n">nb_ec_codes_transferred</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;transferred_ec_codes&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">nb_ec_codes_incomplete</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;incomplete_ec_codes&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">nb_reactions_dropped</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nb_of_reactions_due_to_unconsistent_ec&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">nb_lines_dropped</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nb_of_lines_dropped_due_to_unconsistent_ec&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">rxn_coverage</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">nb_reactions</span> <span class="o">/</span> <span class="n">nb_model_reactions</span> <span class="k">if</span> <span class="n">nb_model_reactions</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="n">percent_ec_retrieved</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">nb_ec_codes</span> <span class="o">/</span> <span class="n">nb_model_ec_codes</span> <span class="k">if</span> <span class="n">nb_model_ec_codes</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="c1"># Pie Chart</span>
    <span class="n">pie_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Retrieved&quot;</span><span class="p">:</span> <span class="n">nb_ec_codes</span><span class="p">,</span>
        <span class="s2">&quot;Transferred&quot;</span><span class="p">:</span> <span class="n">nb_ec_codes_transferred</span><span class="p">,</span>
        <span class="s2">&quot;Incomplete&quot;</span><span class="p">:</span> <span class="n">nb_ec_codes_incomplete</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">pie_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pie_data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">}</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span>
        <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">pie_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">pie_data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
        <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#55bb55&quot;</span><span class="p">,</span> <span class="s2">&quot;#ee9944&quot;</span><span class="p">,</span> <span class="s2">&quot;#cc4455&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">textinfo</span><span class="o">=</span><span class="s2">&quot;percent+label&quot;</span><span class="p">,</span> <span class="n">textfont_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">pie_chart_html</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">)</span>

    <span class="c1"># Time</span>
    <span class="n">generated_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

    <span class="c1"># Html report</span>
    <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;!DOCTYPE html&gt;</span>
<span class="s2">    &lt;html lang=&quot;en&quot;&gt;</span>
<span class="s2">    &lt;head&gt;</span>
<span class="s2">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">        &lt;title&gt;Extract kcat Report&lt;/title&gt;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">report_style</span><span class="p">()</span><span class="si">}</span>
<span class="s2">    &lt;/head&gt;</span>
<span class="s2">    &lt;body&gt;</span>
<span class="s2">        &lt;header&gt;</span>
<span class="s2">            &lt;canvas id=&quot;shader-canvas&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">            &lt;div class=&quot;overlay&quot;&gt;</span>
<span class="s2">                &lt;h1&gt;Extract k&lt;sub&gt;cat&lt;/sub&gt; Report&lt;/h1&gt;</span>
<span class="s2">                &lt;p&gt;Generated on </span><span class="si">{</span><span class="n">generated_time</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/header&gt;</span>

<span class="s2">        &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">            &lt;!-- Model Overview --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Model Overview&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;stats-grid&quot;&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Model ID&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">nb_model_reactions</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Reactions&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">nb_model_metabolites</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Metabolites&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">nb_model_genes</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Genes&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;!-- kcat Extraction Table --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;k&lt;sub&gt;cat&lt;/sub&gt; Extraction Statistics&lt;/h2&gt;</span>
<span class="s2">                &lt;table&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Metric&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Value&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Visualization&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Reactions with EC info&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">nb_reactions</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">rxn_coverage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span>
<span class="s2">                            &lt;div class=&quot;progress&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;progress-bar-table&quot; style=&quot;width:</span><span class="si">{</span><span class="n">rxn_coverage</span><span class="si">}</span><span class="s2">%;&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                            &lt;/div&gt;</span>
<span class="s2">                        &lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;EC codes retrieved in KEGG&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">nb_ec_codes</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">percent_ec_retrieved</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span>
<span class="s2">                            &lt;div class=&quot;progress&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;progress-bar-table&quot; style=&quot;width:</span><span class="si">{</span><span class="n">percent_ec_retrieved</span><span class="si">}</span><span class="s2">%;&quot;&gt;&lt;/div&gt;</span>
<span class="s2">                            &lt;/div&gt;</span>
<span class="s2">                        &lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Total rows in output (Rxn - EC - Enzyme - Substrate)&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;-&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/table&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;!-- EC Issues Table --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Issues in EC Assignment&lt;/h2&gt;</span>
<span class="s2">                &lt;table&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Cases&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Count&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Transferred EC codes&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">nb_ec_codes_transferred</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Incomplete EC codes&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">nb_ec_codes_incomplete</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Number of reactions dropped due to inconsistent EC codes&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">nb_reactions_dropped</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Number of k&lt;sub&gt;cat&lt;/sub&gt; values dropped due to inconsistent EC codes&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">nb_lines_dropped</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/table&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;!-- Pie Chart Section --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;EC Distribution&lt;/h2&gt;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">pie_chart_html</span><span class="si">}</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;footer&gt;WILDkCAT&lt;/footer&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shader</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_shader</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_simple</span><span class="p">()</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;/body&gt;</span>
<span class="s2">    &lt;/html&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Save report</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">report_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports/extract_report.html&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HTML report saved to &#39;</span><span class="si">{</span><span class="n">report_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_final" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_final</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">final_df</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a full HTML report summarizing retrieval results, including kcat distributions and coverage.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metabolic model object containing reactions, metabolites, and genes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>final_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing the final kcat assignments from run_prediction_part2 function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function saves the generated HTML report to 'reports/general_report.html'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_final</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">final_df</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a full HTML report summarizing retrieval results, including kcat distributions and coverage.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model (cobra.Model): The metabolic model object containing reactions, metabolites, and genes.</span>
<span class="sd">        final_df (pd.DataFrame): DataFrame containing the final kcat assignments from run_prediction_part2 function</span>

<span class="sd">    Returns: </span>
<span class="sd">        None: The function saves the generated HTML report to &#39;reports/general_report.html&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model information </span>
    <span class="n">nb_model_reactions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span>
    <span class="n">nb_model_metabolites</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span>
    <span class="n">nb_model_genes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">genes</span><span class="p">)</span>


    <span class="n">df</span> <span class="o">=</span> <span class="n">final_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
    <span class="n">generated_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

    <span class="c1"># Utility to convert matplotlib figures to base64 &lt;img&gt;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fig_to_base64</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;div class=&quot;plot-container&quot;&gt;&lt;img src=&quot;data:image/png;base64,</span><span class="si">{</span><span class="n">encoded</span><span class="si">}</span><span class="s1">&quot;&gt;&lt;/div&gt;&#39;</span>

    <span class="c1"># Distribution plots</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_kcat_distribution_stacked</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="c1"># Ensure numeric kcat</span>
        <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

        <span class="c1"># Drop NaNs for both columns</span>
        <span class="n">valid_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">column_name</span><span class="p">,</span> <span class="n">source</span><span class="p">])</span>
        <span class="n">kcat_values</span> <span class="o">=</span> <span class="n">valid_df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">matched</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kcat_values</span><span class="p">)</span>
        <span class="n">match_percent</span> <span class="o">=</span> <span class="n">matched</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">kcat_values</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="c1"># Define log bins</span>
            <span class="n">min_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">kcat_values</span><span class="o">.</span><span class="n">min</span><span class="p">()))))</span>
            <span class="n">max_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">kcat_values</span><span class="o">.</span><span class="n">max</span><span class="p">())))</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

            <span class="c1"># Prepare data for stacked histogram</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="n">valid_df</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="n">grouped_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">valid_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">valid_df</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">==</span> <span class="n">src</span><span class="p">,</span> <span class="n">column_name</span><span class="p">]</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">]</span>

            <span class="c1"># Colors from seaborn palette</span>
            <span class="c1"># Fixed color mapping</span>
            <span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;brenda&quot;</span><span class="p">:</span> <span class="s2">&quot;#55bb55&quot;</span><span class="p">,</span>   <span class="c1"># green</span>
                <span class="s2">&quot;sabio_rk&quot;</span><span class="p">:</span> <span class="s2">&quot;#2277cc&quot;</span><span class="p">,</span> <span class="c1"># blue</span>
                <span class="s2">&quot;catapro&quot;</span><span class="p">:</span> <span class="s2">&quot;#eedd00&quot;</span><span class="p">,</span>  <span class="c1"># yellow</span>
                <span class="s2">&quot;Unknown&quot;</span><span class="p">:</span> <span class="s2">&quot;#dddddd&quot;</span>   <span class="c1"># gray</span>
            <span class="p">}</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s2">&quot;#999999&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">]</span>  <span class="c1"># fallback gray</span>

            <span class="c1"># Plot</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grouped_values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sources</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">min_exp</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">max_exp</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">LogFormatter</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;kcat (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">matched</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">match_percent</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Source&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">fig_to_base64</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;&lt;p&gt;No valid values available for plotting.&lt;/p&gt;&quot;</span>

    <span class="n">img_final</span> <span class="o">=</span> <span class="n">plot_kcat_distribution_stacked</span><span class="p">(</span>
        <span class="s1">&#39;kcat&#39;</span><span class="p">,</span> <span class="s2">&quot;kcat distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Coverage</span>
    <span class="n">db_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Unknown&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">total_db</span> <span class="o">=</span> <span class="n">db_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;brenda&quot;</span><span class="p">:</span> <span class="s2">&quot;#55bb55&quot;</span><span class="p">,</span>      <span class="c1"># blue</span>
        <span class="s2">&quot;sabio_rk&quot;</span><span class="p">:</span> <span class="s2">&quot;#2277cc&quot;</span><span class="p">,</span>    <span class="c1"># orange</span>
        <span class="s2">&quot;catapro&quot;</span><span class="p">:</span> <span class="s2">&quot;#eedd00&quot;</span><span class="p">,</span>     <span class="c1"># green</span>
        <span class="s2">&quot;Unknown&quot;</span><span class="p">:</span> <span class="s2">&quot;#ddd&quot;</span>      <span class="c1"># gray</span>
    <span class="p">}</span>

    <span class="n">db_colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">db</span><span class="p">:</span> <span class="n">colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="s2">&quot;#ddd&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">db_counts</span><span class="o">.</span><span class="n">index</span><span class="p">}</span>

    <span class="n">progress_segments</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">legend_items</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">db_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">percent</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total_db</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">progress_segments</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;div class=&quot;progress-segment&quot; style=&quot;width:</span><span class="si">{</span><span class="n">percent</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%; background-color:</span><span class="si">{</span><span class="n">db_colors</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="si">}</span><span class="s2">;&quot;</span>
<span class="s2">                title=&quot;</span><span class="si">{</span><span class="n">db</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">percent</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;&gt;&lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">legend_items</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;span style=&quot;display:flex; align-items:center; margin-right:15px; margin-bottom:5px;&quot;&gt;</span>
<span class="s2">                &lt;span style=&quot;display:flex; align-items:center; width:16px; height:16px; </span>
<span class="s2">                            background:</span><span class="si">{</span><span class="n">db_colors</span><span class="p">[</span><span class="n">db</span><span class="p">]</span><span class="si">}</span><span class="s2">; border:1px solid #000; margin-right:5px;&quot;&gt;&lt;/span&gt;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">db</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">percent</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)</span>
<span class="s2">            &lt;/span&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="n">progress_bar</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div class=&quot;progress-multi&quot; style=&quot;height: 18px; margin-bottom:18px; display:flex;&quot;&gt;</span>
<span class="s2">            </span><span class="si">{</span><span class="n">progress_segments</span><span class="si">}</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        &lt;div style=&quot;margin-top:10px; display:flex; justify-content:center; flex-wrap: wrap;&quot;&gt;</span><span class="si">{</span><span class="n">legend_items</span><span class="si">}</span><span class="s2">&lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Statistics </span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;rxn&quot;</span><span class="p">)</span>
    <span class="n">rxns_with_kcat</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;kcat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>
    <span class="n">nb_rxn</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">ngroups</span>
    <span class="n">nb_rxn_with_kcat</span> <span class="o">=</span> <span class="n">rxns_with_kcat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">coverage</span> <span class="o">=</span> <span class="n">nb_rxn_with_kcat</span> <span class="o">/</span> <span class="n">nb_rxn</span>
    <span class="n">coverage_total</span> <span class="o">=</span> <span class="n">nb_rxn_with_kcat</span> <span class="o">/</span> <span class="n">nb_model_reactions</span>

    <span class="n">kcat_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;kcat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">matched</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kcat_values</span><span class="p">)</span>
    <span class="n">match_percent</span> <span class="o">=</span> <span class="n">matched</span> <span class="o">/</span> <span class="n">total</span>

    <span class="c1"># HTML</span>
    <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;!DOCTYPE html&gt;</span>
<span class="s2">    &lt;html lang=&quot;en&quot;&gt;</span>
<span class="s2">    &lt;head&gt;</span>
<span class="s2">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">        &lt;title&gt;WILDkCAT Report&lt;/title&gt;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">report_style</span><span class="p">()</span><span class="si">}</span>
<span class="s2">    &lt;/head&gt;</span>
<span class="s2">    &lt;body&gt;</span>
<span class="s2">        &lt;header&gt;</span>
<span class="s2">            &lt;canvas id=&quot;shader-canvas&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">            &lt;div class=&quot;overlay&quot;&gt;</span>
<span class="s2">                &lt;h1&gt;WILDkCAT Report&lt;/h1&gt;</span>
<span class="s2">                &lt;p&gt;Generated on </span><span class="si">{</span><span class="n">generated_time</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/header&gt;</span>

<span class="s2">        &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Introduction&lt;/h2&gt;</span>
<span class="s2">                &lt;p style=&quot;margin-bottom:20px; font-size:14px; color:#555; text-align: justify;&quot;&gt;</span>
<span class="s2">                    This report provides a summary of the performance of k&lt;sub&gt;cat&lt;/sub&gt; value extraction, retrieval, and prediction for the specified metabolic model. </span>
<span class="s2">                    It presents statistics on k&lt;sub&gt;cat&lt;/sub&gt; values successfully retrieved, whether experimental or predicted.</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">                &lt;p style=&quot;margin-bottom:20px; font-size:14px; color:#555; text-align: justify;&quot;&gt;</span>
<span class="s2">                    The output file, containing the full list of k&lt;sub&gt;cat&lt;/sub&gt; values associated with each reaction, are available as a tab-separated file (TSV) at the default output path: &lt;code&gt;output/model_name_kcat_full&lt;/code&gt;.</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Model Overview&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;stats-grid&quot;&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Model ID&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">nb_model_reactions</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Reactions&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">nb_model_metabolites</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Metabolites&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">nb_model_genes</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Genes&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;div class=&quot;card&quot; style=&quot;padding:20px; margin-bottom:20px;&quot;&gt;</span>
<span class="s2">                &lt;h2 style=&quot;margin-bottom:10px;&quot;&gt;Coverage&lt;/h2&gt;</span>

<span class="s2">                &lt;!-- Explanation --&gt;</span>
<span class="s2">                &lt;p style=&quot;margin-bottom:20px; font-size:14px; color:#555; text-align: justify;&quot;&gt;</span>
<span class="s2">                    The coverage section reports the number of k&lt;sub&gt;cat&lt;/sub&gt; values retrieved for the model and the number of reactions that have at least one </span>
<span class="s2">                    associated k&lt;sub&gt;cat&lt;/sub&gt; value, whether experimental or predicted. This provides a measure of how extensively the models reactions are </span>
<span class="s2">                    annotated with kinetic data.</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">                &lt;p style=&quot;margin-bottom:20px; font-size:14px; color:#555; text-align: justify;&quot;&gt;</span>
<span class="s2">                    Higher coverage indicates that a larger fraction of reactions are constrained by k&lt;sub&gt;cat&lt;/sub&gt; values, </span>
<span class="s2">                    improving the accuracy and reliability of enzyme-constrained simulations.</span>
<span class="s2">                &lt;/p&gt;</span>

<span class="s2">                &lt;!-- Global coverage progress bar --&gt;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">progress_bar</span><span class="si">}</span><span class="s2">        </span>

<span class="s2">                &lt;!-- Detailed stats --&gt;</span>
<span class="s2">                &lt;table class=&quot;table&quot; style=&quot;width:100%; border-spacing:0; border-collapse: collapse;&quot;&gt;</span>
<span class="s2">                    &lt;tbody&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td style=&quot;padding:8px 12px;&quot;&gt;Reactions with EC information with at least one kcat values&lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;padding:8px 12px;&quot;&gt;</span><span class="si">{</span><span class="n">nb_rxn_with_kcat</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">coverage</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">)&lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;width:40%;&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;progress&quot; style=&quot;height:18px;&quot;&gt;</span>
<span class="s2">                                    &lt;div class=&quot;progress-bar-table&quot; </span>
<span class="s2">                                        style=&quot;width:</span><span class="si">{</span><span class="n">coverage</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">; background-color:#4caf50;&quot;&gt;</span>
<span class="s2">                                    &lt;/div&gt;</span>
<span class="s2">                                &lt;/div&gt;</span>
<span class="s2">                            &lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td style=&quot;padding:8px 12px;&quot;&gt;Reactions in the model with at least one kcat values&lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;padding:8px 12px;&quot;&gt;</span><span class="si">{</span><span class="n">nb_rxn_with_kcat</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">coverage_total</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">)&lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;width:40%;&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;progress&quot; style=&quot;height:18px;&quot;&gt;</span>
<span class="s2">                                    &lt;div class=&quot;progress-bar-table&quot; </span>
<span class="s2">                                        style=&quot;width:</span><span class="si">{</span><span class="n">coverage_total</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">; background-color:#4caf50;&quot;&gt;</span>
<span class="s2">                                    &lt;/div&gt;</span>
<span class="s2">                                &lt;/div&gt;</span>
<span class="s2">                            &lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                        &lt;tr&gt;</span>
<span class="s2">                            &lt;td style=&quot;padding:8px 12px;&quot;&gt;k&lt;sub&gt;cat&lt;/sub&gt; values retrieved &lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;padding:8px 12px;&quot;&gt;</span><span class="si">{</span><span class="n">matched</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">match_percent</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">)&lt;/td&gt;</span>
<span class="s2">                            &lt;td style=&quot;width:40%;&quot;&gt;</span>
<span class="s2">                                &lt;div class=&quot;progress&quot; style=&quot;height:18px;&quot;&gt;</span>
<span class="s2">                                    &lt;div class=&quot;progress-bar-table&quot; </span>
<span class="s2">                                        style=&quot;width:</span><span class="si">{</span><span class="n">match_percent</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">; background-color:#4caf50;&quot;&gt;</span>
<span class="s2">                                    &lt;/div&gt;</span>
<span class="s2">                                &lt;/div&gt;</span>
<span class="s2">                            &lt;/td&gt;</span>
<span class="s2">                        &lt;/tr&gt;</span>
<span class="s2">                    &lt;/tbody&gt;</span>
<span class="s2">                &lt;/table&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;k&lt;sub&gt;cat&lt;/sub&gt; Distribution&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;img-section&quot;&gt;</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">img_final</span><span class="si">}</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;footer&gt;WILDkCAT&lt;/footer&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shader</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_shader</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_simple</span><span class="p">()</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;/body&gt;</span>
<span class="s2">    &lt;/html&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">report_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports/general_report.html&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HTML report saved to &#39;</span><span class="si">{</span><span class="n">report_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">report_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_prediction_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_prediction_input</span><span class="p">(</span><span class="n">catapro_df</span><span class="p">,</span> <span class="n">report_statistics</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a detailed HTML report summarizing the kcat prediction input statistics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>catapro_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing the CataPro input data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>report_statistics</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with statistics about the prediction input.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the report will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shader</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, includes a shader canvas background in the report. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function saves the generated HTML report to 'reports/predict_kcat_report.html'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_prediction_input</span><span class="p">(</span><span class="n">catapro_df</span><span class="p">,</span> <span class="n">report_statistics</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a detailed HTML report summarizing the kcat prediction input statistics.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        catapro_df (pd.DataFrame): DataFrame containing the CataPro input data.</span>
<span class="sd">        report_statistics (dict): Dictionary with statistics about the prediction input.</span>
<span class="sd">        output_folder (str): Path to the output folder where the report will be saved.</span>
<span class="sd">        shader (bool, optional): If True, includes a shader canvas background in the report. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: The function saves the generated HTML report to &#39;reports/predict_kcat_report.html&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># CataPro Statistics </span>
    <span class="n">total_catapro_entries</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">catapro_df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Report Statistics</span>
    <span class="n">rxn_covered</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="p">[</span><span class="s1">&#39;rxn_covered&#39;</span><span class="p">]</span>
    <span class="n">cofactors_covered</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="p">[</span><span class="s1">&#39;cofactor_identified&#39;</span><span class="p">]</span>
    <span class="n">no_catalytic</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="p">[</span><span class="s1">&#39;no_catalytic&#39;</span><span class="p">]</span>
    <span class="n">kegg_missing</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="p">[</span><span class="s1">&#39;kegg_no_matching&#39;</span><span class="p">]</span>
    <span class="n">duplicates</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="p">[</span><span class="s1">&#39;duplicates_enzyme_substrates&#39;</span><span class="p">]</span>
    <span class="n">missing_enzyme</span> <span class="o">=</span> <span class="n">report_statistics</span><span class="p">[</span><span class="s1">&#39;missing_enzymes&#39;</span><span class="p">]</span>

    <span class="n">total_rxn</span> <span class="o">=</span> <span class="n">rxn_covered</span> <span class="o">+</span> <span class="n">no_catalytic</span> <span class="o">+</span> <span class="n">kegg_missing</span> <span class="o">+</span> <span class="n">missing_enzyme</span>
    <span class="n">rxn_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">rxn_covered</span> <span class="o">/</span> <span class="n">total_rxn</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_rxn</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="c1"># Time</span>
    <span class="n">generated_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

    <span class="c1"># Html report</span>
    <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;!DOCTYPE html&gt;</span>
<span class="s2">    &lt;html lang=&quot;en&quot;&gt;</span>
<span class="s2">    &lt;head&gt;</span>
<span class="s2">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">        &lt;title&gt;Predict kcat Report&lt;/title&gt;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">report_style</span><span class="p">()</span><span class="si">}</span>
<span class="s2">    &lt;/head&gt;</span>
<span class="s2">    &lt;body&gt;</span>
<span class="s2">        &lt;header&gt;</span>
<span class="s2">            &lt;canvas id=&quot;shader-canvas&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">            &lt;div class=&quot;overlay&quot;&gt;</span>
<span class="s2">                &lt;h1&gt;Predict k&lt;sub&gt;cat&lt;/sub&gt; Report&lt;/h1&gt;</span>
<span class="s2">                &lt;p&gt;Generated on </span><span class="si">{</span><span class="n">generated_time</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/header&gt;</span>

<span class="s2">        &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">            &lt;!-- CataPro Overview --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Overview&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;stats-grid&quot;&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">total_rxn</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Total k&lt;sub&gt;cat&lt;/sub&gt; values&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">rxn_covered</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;k&lt;sub&gt;cat&lt;/sub&gt; to be predicted (</span><span class="si">{</span><span class="n">rxn_coverage</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;!-- Prediction kcat Table --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;k&lt;sub&gt;cat&lt;/sub&gt; Prediction Statistics&lt;/h2&gt;</span>
<span class="s2">                &lt;table&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Metric&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Value&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Total of entries in CataPro input file&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">total_catapro_entries</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Number of cofactor identified&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">cofactors_covered</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/table&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Issues in k&lt;sub&gt;cat&lt;/sub&gt; Predictions&lt;/h2&gt;</span>
<span class="s2">                &lt;table&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Metric&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Value&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Entries with no catalytic enzyme identified&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">no_catalytic</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Entries with missing KEGG IDs&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">kegg_missing</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Entries with missing enzyme information&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">missing_enzyme</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/table&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Duplicates&lt;/h2&gt;</span>
<span class="s2">                &lt;table&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Metric&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Value&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Number of duplicates&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;</span><span class="si">{</span><span class="n">duplicates</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/table&gt;</span>
<span class="s2">                &lt;p&gt;</span>
<span class="s2">                    Duplicates occur when multiple reactions share the same enzyme-substrate combination. </span>
<span class="s2">                    A high number of duplicates may result from multiple enzyme complexes sharing the same catalytic enzyme.</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;!-- Prediction Instructions --&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Running k&lt;sub&gt;cat&lt;/sub&gt; Predictions with CataPro&lt;/h2&gt;</span>
<span class="s2">                &lt;p&gt;</span>
<span class="s2">                    This report provides the input needed to run the CataPro machine learning model </span>
<span class="s2">                    (&lt;a href=&quot;https://github.com/zchwang/CataPro&quot; target=&quot;_blank&quot;&gt;CataPro repository&lt;/a&gt;). </span>
<span class="s2">                    Follow the instructions in the repository to set up the environment and generate k&lt;sub&gt;cat&lt;/sub&gt; predictions.</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">    &lt;footer&gt;WILDkCAT&lt;/footer&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shader</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_shader</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_simple</span><span class="p">()</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;/body&gt;</span>
<span class="s2">    &lt;/html&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Save report</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">report_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports/predict_report.html&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HTML report saved to &#39;</span><span class="si">{</span><span class="n">report_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_retrieval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_retrieval</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a styled HTML report summarizing the kcat matching results,
including kcat value distribution and matching score repartition.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing data from the run_retrieval function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder where the report will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shader</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, includes a shader canvas background in the report. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function saves the generated HTML report to 'reports/retrieve_kcat_report.html'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_retrieval</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span><span class="n">shader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a styled HTML report summarizing the kcat matching results,</span>
<span class="sd">    including kcat value distribution and matching score repartition.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        df (pd.DataFrame): DataFrame containing data from the run_retrieval function.</span>
<span class="sd">        output_folder (str): Path to the output folder where the report will be saved.</span>
<span class="sd">        shader (bool, optional): If True, includes a shader canvas background in the report. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: The function saves the generated HTML report to &#39;reports/retrieve_kcat_report.html&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure numeric kcat values to avoid TypeError on comparisons</span>
    <span class="n">kcat_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;kcat&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># Only use scores present in the data</span>
    <span class="n">present_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;matching_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="n">score_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;matching_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">present_scores</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">matched</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kcat_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">match_percent</span> <span class="o">=</span> <span class="n">matched</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">score_percent</span> <span class="o">=</span> <span class="p">(</span><span class="n">score_counts</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">total</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">present_scores</span><span class="p">)</span>

    <span class="c1"># Distinct colors for each score (up to 12, then cycle)</span>
    <span class="c1"># Gradient colors from green (best score) to red (worst score)</span>
    <span class="n">distinct_colors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;#27ae60&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#43b76e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#60c07c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#7cc98a&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#98d298&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#b5dbb6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#d1e4c4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#f1e9b6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#f7d97c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#f9c74f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#f8961e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#f3722c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#e67e22&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#e74c3c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#c0392b&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#a93226&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#922b21&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#7b241c&quot;</span>
    <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">score_color</span><span class="p">(</span><span class="n">score</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">present_scores</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">distinct_colors</span><span class="p">[</span><span class="n">idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">distinct_colors</span><span class="p">)]</span>

    <span class="n">generated_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>

    <span class="c1"># Histogram with stacked bars for scores</span>
    <span class="n">kcat_hist_base64</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">kcat_values</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">min_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">kcat_values</span><span class="o">.</span><span class="n">min</span><span class="p">()))))</span>
        <span class="n">max_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">kcat_values</span><span class="o">.</span><span class="n">max</span><span class="p">())))</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">min_exp</span><span class="p">,</span> <span class="n">max_exp</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

        <span class="c1"># Stacked histogram by score</span>

        <span class="n">hist_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;matching_score&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">score</span><span class="p">][</span><span class="s1">&#39;kcat&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">present_scores</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hist_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">score_color</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">present_scores</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Score </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">present_scores</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="n">min_exp</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">max_exp</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">LogFormatter</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;kcat (s)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Matching Score&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">kcat_hist_base64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="c1"># HTML start</span>
    <span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;!DOCTYPE html&gt;</span>
<span class="s2">    &lt;html lang=&quot;en&quot;&gt;</span>
<span class="s2">    &lt;head&gt;</span>
<span class="s2">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="s2">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="s2">        &lt;title&gt;Retrieve kcat Report&lt;/title&gt;</span>
<span class="s2">        </span><span class="si">{</span><span class="n">report_style</span><span class="p">()</span><span class="si">}</span>
<span class="s2">    &lt;/head&gt;</span>
<span class="s2">    &lt;body&gt;</span>
<span class="s2">        &lt;header&gt;</span>
<span class="s2">            &lt;canvas id=&quot;shader-canvas&quot;&gt;&lt;/canvas&gt;</span>
<span class="s2">            &lt;div class=&quot;overlay&quot;&gt;</span>
<span class="s2">                &lt;h1&gt;Retrieve k&lt;sub&gt;cat&lt;/sub&gt; Report&lt;/h1&gt;</span>
<span class="s2">                &lt;p&gt;Generated on </span><span class="si">{</span><span class="n">generated_time</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/header&gt;</span>

<span class="s2">        &lt;div class=&quot;container&quot;&gt;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Overview&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;stats-grid&quot;&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Total Entries&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                    &lt;div class=&quot;stat-box&quot;&gt;</span>
<span class="s2">                        &lt;h3&gt;</span><span class="si">{</span><span class="n">matched</span><span class="si">}</span><span class="s2">&lt;/h3&gt;</span>
<span class="s2">                        &lt;p&gt;Matched k&lt;sub&gt;cat&lt;/sub&gt; (</span><span class="si">{</span><span class="n">match_percent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&lt;/p&gt;</span>
<span class="s2">                    &lt;/div&gt;</span>
<span class="s2">                &lt;/div&gt;</span>
<span class="s2">            &lt;/div&gt;</span>

<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Matching Score Distribution&lt;/h2&gt;</span>
<span class="s2">                &lt;div class=&quot;progress-stacked&quot;&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Add progress bars only for present scores</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">present_scores</span><span class="p">:</span>
        <span class="n">percent</span> <span class="o">=</span> <span class="n">score_percent</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">percent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;div class=&quot;progress-bar&quot; style=&quot;width:</span><span class="si">{</span><span class="n">percent</span><span class="si">}</span><span class="s1">%;background:</span><span class="si">{</span><span class="n">score_color</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="si">}</span><span class="s1">;&quot; title=&quot;Score </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">percent</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&quot;&gt;&lt;/div&gt;&#39;</span>

    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;div class=&quot;legend&quot;&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Add legend only for present scores</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">present_scores</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;div class=&quot;legend-item&quot;&gt;&lt;div class=&quot;legend-color&quot; style=&quot;background:</span><span class="si">{</span><span class="n">score_color</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="si">}</span><span class="s1">;&quot;&gt;&lt;/div&gt; Score </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s1">&lt;/div&gt;&#39;</span>

    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">            &lt;table&gt;</span>
<span class="s2">                &lt;tr&gt;</span>
<span class="s2">                    &lt;th&gt;Score&lt;/th&gt;</span>
<span class="s2">                    &lt;th&gt;Count&lt;/th&gt;</span>
<span class="s2">                    &lt;th&gt;Percent&lt;/th&gt;</span>
<span class="s2">                &lt;/tr&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Table rows only for present scores</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">present_scores</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;</span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s1">&lt;/td&gt;&lt;td&gt;</span><span class="si">{</span><span class="n">score_counts</span><span class="p">[</span><span class="n">score</span><span class="p">]</span><span class="si">}</span><span class="s1">&lt;/td&gt;&lt;td&gt;</span><span class="si">{</span><span class="n">score_percent</span><span class="p">[</span><span class="n">score</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&lt;/td&gt;&lt;/tr&gt;&#39;</span>

    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;/table&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Histogram section (stacked by score)</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">            &lt;h2&gt;Distribution of k&lt;sub&gt;cat&lt;/sub&gt; values (Stacked by Matching Score)&lt;/h2&gt;</span>
<span class="s2">            &lt;div class=&quot;img-section&quot;&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kcat_hist_base64</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;&lt;img src=&quot;data:image/png;base64,</span><span class="si">{</span><span class="n">kcat_hist_base64</span><span class="si">}</span><span class="s1">&quot; alt=&quot;k&lt;sub&gt;cat&lt;/sub&gt; Distribution&quot;&gt;&#39;</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Metadata section</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="s2">                &lt;h2&gt;Matching Score&lt;/h2&gt;</span>
<span class="s2">                &lt;p&gt;</span>
<span class="s2">                    The matching score evaluates how well a candidate k&lt;sub&gt;cat&lt;/sub&gt; entry fits the query enzyme and conditions. </span>
<span class="s2">                    A lower score indicates a better match (0 = best possible, 15 = no match).</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">                &lt;h3&gt;Scoring process:&lt;/h3&gt;</span>
<span class="s2">                &lt;ul&gt;</span>
<span class="s2">                    &lt;li&gt;&lt;b&gt;Catalytic enzyme:&lt;/b&gt; Check if the reported enzyme matches the expected catalytic enzyme(s).&lt;/li&gt;</span>
<span class="s2">                    &lt;li&gt;&lt;b&gt;Organism:&lt;/b&gt; Penalize mismatches between the source organism and the target organism.&lt;/li&gt;</span>
<span class="s2">                    &lt;li&gt;&lt;b&gt;Enzyme variant:&lt;/b&gt; Exclude or penalize mutant/engineered variants (wildtype preferred).&lt;/li&gt;</span>
<span class="s2">                    &lt;li&gt;&lt;b&gt;pH:&lt;/b&gt; Check whether the reported pH is consistent with the desired experimental range.&lt;/li&gt;</span>
<span class="s2">                    &lt;li&gt;&lt;b&gt;Substrate:&lt;/b&gt; Verify substrate compatibility with the catalytic reaction.&lt;/li&gt;</span>
<span class="s2">                    &lt;li&gt;&lt;b&gt;Temperature:&lt;/b&gt; Penalize deviations from the target temperature; </span>
<span class="s2">                        if possible, adjust kcat values using the Arrhenius equation.&lt;/li&gt;</span>
<span class="s2">                &lt;/ul&gt;</span>

<span class="s2">                &lt;h3&gt;Score breakdown (default penalties):&lt;/h3&gt;</span>
<span class="s2">                &lt;table border=&quot;1&quot; cellpadding=&quot;6&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse; text-align: left;&quot;&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;th&gt;Criterion&lt;/th&gt;</span>
<span class="s2">                        &lt;th&gt;Penalty&lt;/th&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Substrate mismatch&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+3&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Catalytic enzyme mismatch&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+2&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Organism mismatch&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+2&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;pH unknown&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+1&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;pH out of range&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+2&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Temperature unknown&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+1&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Temperature out of range&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+2&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                    &lt;tr&gt;</span>
<span class="s2">                        &lt;td&gt;Enzyme variant unknown&lt;/td&gt;</span>
<span class="s2">                        &lt;td&gt;+1&lt;/td&gt;</span>
<span class="s2">                    &lt;/tr&gt;</span>
<span class="s2">                &lt;/table&gt;</span>

<span class="s2">                &lt;p&gt;</span>
<span class="s2">                    Candidates are then ranked by:</span>
<span class="s2">                    &lt;ol&gt;</span>
<span class="s2">                        &lt;li&gt;Lowest total score&lt;/li&gt;</span>
<span class="s2">                        &lt;li&gt;Highest sequence identity percentage to the target enzyme&lt;/li&gt;</span>
<span class="s2">                        &lt;li&gt;Closest organism compared to the target organism.&lt;/li&gt;</span>
<span class="s2">                        &lt;li&gt;Adjusted k&lt;sub&gt;cat&lt;/sub&gt; value (favoring the highest value by default)&lt;/li&gt;</span>
<span class="s2">                    &lt;/ol&gt;</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">                &lt;p&gt;</span>
<span class="s2">                    The best candidate is the one with the lowest score after these checks. </span>
<span class="s2">                    If multiple candidates tie on score, sequence identity (or organism if sequence is not available) and k&lt;sub&gt;cat&lt;/sub&gt; values break the tie.</span>
<span class="s2">                &lt;/p&gt;</span>
<span class="s2">            &lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>

<span class="s2">        &lt;footer&gt;WILDkCAT&lt;/footer&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shader</span><span class="p">:</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_shader</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="n">report_simple</span><span class="p">()</span>
    <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;/body&gt;</span>
<span class="s2">    &lt;/html&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Save HTML</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports&quot;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">report_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">&quot;reports/retrieve_report.html&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HTML report saved to &#39;</span><span class="si">{</span><span class="n">report_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_shader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_shader</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return HTML and GLSL shader code for report background. Adapted from localthunk (https://localthunk.com)</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_shader</span><span class="p">():</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return HTML and GLSL shader code for report background. Adapted from localthunk (https://localthunk.com)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;!-- Background adapted from original work by localthunk (https://localthunk.com) --&gt;</span>
<span class="s2">    &lt;script id=&quot;fragShader&quot; type=&quot;x-shader/x-fragment&quot;&gt;</span>
<span class="s2">    precision highp float;</span>
<span class="s2">    uniform vec2 iResolution;</span>
<span class="s2">    uniform float iTime;</span>
<span class="s2">    #define SPIN_ROTATION -1.0</span>
<span class="s2">    #define SPIN_SPEED 3.5</span>
<span class="s2">    #define OFFSET vec2(0.0)</span>
<span class="s2">    #define COLOUR_1 vec4(0.2, 0.4, 0.7, 1.0)</span>
<span class="s2">    #define COLOUR_2 vec4(0.6, 0.75, 0.9, 1.0)</span>
<span class="s2">    #define COLOUR_3 vec4(0.2, 0.2, 0.25, 1.0)</span>
<span class="s2">    #define CONTRAST 3.5</span>
<span class="s2">    #define LIGTHING 0.4</span>
<span class="s2">    #define SPIN_AMOUNT 0.25</span>
<span class="s2">    #define PIXEL_FILTER 745.0</span>
<span class="s2">    #define SPIN_EASE 1.0</span>
<span class="s2">    #define PI 3.14159265359</span>
<span class="s2">    #define IS_ROTATE false</span>
<span class="s2">    vec4 effect(vec2 screenSize, vec2 screen_coords) {</span>
<span class="s2">        float pixel_size = length(screenSize.xy) / PIXEL_FILTER;</span>
<span class="s2">        vec2 uv = (floor(screen_coords.xy*(1./pixel_size))*pixel_size - 0.5*screenSize.xy)/length(screenSize.xy) - OFFSET;</span>
<span class="s2">        float uv_len = length(uv);</span>
<span class="s2">        float speed = (SPIN_ROTATION*SPIN_EASE*0.2);</span>
<span class="s2">        if(IS_ROTATE) {</span>
<span class="s2">        speed = iTime * speed;</span>
<span class="s2">        }</span>
<span class="s2">        speed += 302.2;</span>
<span class="s2">        float new_pixel_angle = atan(uv.y, uv.x) + speed - SPIN_EASE*20.*(1.*SPIN_AMOUNT*uv_len + (1. - 1.*SPIN_AMOUNT));</span>
<span class="s2">        vec2 mid = (screenSize.xy/length(screenSize.xy))/2.;</span>
<span class="s2">        uv = (vec2((uv_len * cos(new_pixel_angle) + mid.x), (uv_len * sin(new_pixel_angle) + mid.y)) - mid);</span>
<span class="s2">        uv *= 30.;</span>
<span class="s2">        speed = iTime*(SPIN_SPEED);</span>
<span class="s2">        vec2 uv2 = vec2(uv.x+uv.y);</span>
<span class="s2">        for(int i=0; i &lt; 5; i++) {</span>
<span class="s2">            uv2 += sin(max(uv.x, uv.y)) + uv;</span>
<span class="s2">            uv  += 0.5*vec2(cos(5.1123314 + 0.353*uv2.y + speed*0.131121),sin(uv2.x - 0.113*speed));</span>
<span class="s2">            uv  -= 1.0*cos(uv.x + uv.y) - 1.0*sin(uv.x*0.711 - uv.y);</span>
<span class="s2">        }</span>
<span class="s2">        float contrast_mod = (0.25*CONTRAST + 0.5*SPIN_AMOUNT + 1.2);</span>
<span class="s2">        float paint_res = min(2., max(0.,length(uv)*(0.035)*contrast_mod));</span>
<span class="s2">        float c1p = max(0.,1. - contrast_mod*abs(1.-paint_res));</span>
<span class="s2">        float c2p = max(0.,1. - contrast_mod*abs(paint_res));</span>
<span class="s2">        float c3p = 1. - min(1., c1p + c2p);</span>
<span class="s2">        float light = (LIGTHING - 0.2)*max(c1p*5. - 4., 0.) + LIGTHING*max(c2p*5. - 4., 0.);</span>
<span class="s2">        return (0.3/CONTRAST)*COLOUR_1 + (1. - 0.3/CONTRAST)*(COLOUR_1*c1p + COLOUR_2*c2p + vec4(c3p*COLOUR_3.rgb, c3p*COLOUR_1.a)) + light;</span>
<span class="s2">    }</span>
<span class="s2">    void mainImage(out vec4 fragColor, in vec2 fragCoord) {</span>
<span class="s2">        vec2 uv = fragCoord/iResolution.xy;</span>
<span class="s2">        fragColor = effect(iResolution.xy, uv * iResolution.xy);</span>
<span class="s2">    }</span>
<span class="s2">    void main() { mainImage(gl_FragColor, gl_FragCoord.xy); }</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">    &lt;script&gt;</span>
<span class="s2">    const canvas = document.getElementById(&quot;shader-canvas&quot;);</span>
<span class="s2">    const gl = canvas.getContext(&quot;webgl&quot;);</span>
<span class="s2">    function resize() {</span>
<span class="s2">        canvas.width = canvas.clientWidth * window.devicePixelRatio;</span>
<span class="s2">        canvas.height = canvas.clientHeight * window.devicePixelRatio;</span>
<span class="s2">        gl.viewport(0, 0, canvas.width, canvas.height);</span>
<span class="s2">    }</span>
<span class="s2">    window.addEventListener(&quot;resize&quot;, resize);</span>
<span class="s2">    resize();</span>
<span class="s2">    const vertexSrc = `</span>
<span class="s2">    attribute vec2 position;</span>
<span class="s2">    void main() {</span>
<span class="s2">        gl_Position = vec4(position, 0.0, 1.0);</span>
<span class="s2">    }</span>
<span class="s2">    `;</span>
<span class="s2">    const fragSrc = document.getElementById(&quot;fragShader&quot;).text;</span>
<span class="s2">    function compileShader(src, type) {</span>
<span class="s2">    const shader = gl.createShader(type);</span>
<span class="s2">    gl.shaderSource(shader, src);</span>
<span class="s2">    gl.compileShader(shader);</span>
<span class="s2">    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {</span>
<span class="s2">        console.error(gl.getShaderInfoLog(shader));</span>
<span class="s2">    }</span>
<span class="s2">    return shader;</span>
<span class="s2">    }</span>
<span class="s2">    const vertexShader = compileShader(vertexSrc, gl.VERTEX_SHADER);</span>
<span class="s2">    const fragmentShader = compileShader(fragSrc, gl.FRAGMENT_SHADER);</span>
<span class="s2">    const program = gl.createProgram();</span>
<span class="s2">    gl.attachShader(program, vertexShader);</span>
<span class="s2">    gl.attachShader(program, fragmentShader);</span>
<span class="s2">    gl.linkProgram(program);</span>
<span class="s2">    gl.useProgram(program);</span>
<span class="s2">    const positionBuffer = gl.createBuffer();</span>
<span class="s2">    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);</span>
<span class="s2">    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([</span>
<span class="s2">    -1, -1, 1, -1, -1, 1,</span>
<span class="s2">    -1, 1, 1, -1, 1, 1</span>
<span class="s2">    ]), gl.STATIC_DRAW);</span>
<span class="s2">    const positionLoc = gl.getAttribLocation(program, &quot;position&quot;);</span>
<span class="s2">    gl.enableVertexAttribArray(positionLoc);</span>
<span class="s2">    gl.vertexAttribPointer(positionLoc, 2, gl.FLOAT, false, 0, 0);</span>
<span class="s2">    const iResolutionLoc = gl.getUniformLocation(program, &quot;iResolution&quot;);</span>
<span class="s2">    const iTimeLoc = gl.getUniformLocation(program, &quot;iTime&quot;);</span>
<span class="s2">    function render(time) {</span>
<span class="s2">    resize();</span>
<span class="s2">    gl.uniform2f(iResolutionLoc, canvas.width, canvas.height);</span>
<span class="s2">    gl.uniform1f(iTimeLoc, time * 0.001);</span>
<span class="s2">    gl.drawArrays(gl.TRIANGLES, 0, 6);</span>
<span class="s2">    requestAnimationFrame(render);</span>
<span class="s2">    }</span>
<span class="s2">    requestAnimationFrame(render);</span>
<span class="s2">    &lt;/script&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_simple" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_simple</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return HTML code for report background.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_simple</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return HTML code for report background.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        header {</span>
<span class="s2">            background-color: #2980b9; /* simple blue background */</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">        }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wildkcat.utils.generate_reports.report_style" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">report_style</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return CSS script for report style.</p>


            <details class="quote">
              <summary>Source code in <code>wildkcat/utils/generate_reports.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">report_style</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return CSS script for report style.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">        body {</span>
<span class="s2">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="s2">            background-color: #f4f6f9;</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            padding: 0;</span>
<span class="s2">            color: #333;</span>
<span class="s2">        }</span>
<span class="s2">        header {</span>
<span class="s2">            position: relative;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            height: 150px;</span>
<span class="s2">            overflow: hidden;</span>
<span class="s2">            display: flex;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            justify-content: center;</span>
<span class="s2">            color: #fff;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">        }</span>
<span class="s2">        header canvas {</span>
<span class="s2">            position: absolute;</span>
<span class="s2">            top: 0; left: 0;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            height: 100%;</span>
<span class="s2">            z-index: 0;</span>
<span class="s2">        }</span>
<span class="s2">        header::before {</span>
<span class="s2">            content: &quot;&quot;;</span>
<span class="s2">            position: absolute;</span>
<span class="s2">            top: 0; left: 0; right: 0; bottom: 0;</span>
<span class="s2">            background: linear-gradient(</span>
<span class="s2">                rgba(0,0,0,0.5),</span>
<span class="s2">                rgba(0,0,0,0.3)</span>
<span class="s2">            );</span>
<span class="s2">            z-index: 1;</span>
<span class="s2">        }</span>
<span class="s2">        header .overlay {</span>
<span class="s2">            position: relative;</span>
<span class="s2">            z-index: 2;</span>
<span class="s2">            padding: 10px 20px;</span>
<span class="s2">            border-radius: 8px;</span>
<span class="s2">        }</span>
<span class="s2">        header h1 {</span>
<span class="s2">            margin: 0;</span>
<span class="s2">            font-size: 2.5rem;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">            text-shadow: 0 2px 6px rgba(0,0,0,0.6);</span>
<span class="s2">        }</span>
<span class="s2">        header p {</span>
<span class="s2">            margin: 8px 0 0;</span>
<span class="s2">            font-size: 1.1rem;</span>
<span class="s2">            text-shadow: 0 1px 4px rgba(0,0,0,0.6);</span>
<span class="s2">        }</span>
<span class="s2">        .container {</span>
<span class="s2">            max-width: 1100px;</span>
<span class="s2">            margin: 30px auto;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">        }</span>
<span class="s2">        .card {</span>
<span class="s2">            background: #fff;</span>
<span class="s2">            border-radius: 12px;</span>
<span class="s2">            padding: 20px;</span>
<span class="s2">            margin-bottom: 20px;</span>
<span class="s2">            box-shadow: 0 2px 8px rgba(0,0,0,0.05);</span>
<span class="s2">        }</span>
<span class="s2">        .card h2 {</span>
<span class="s2">            margin-top: 0;</span>
<span class="s2">            color: #2980b9;</span>
<span class="s2">            border-bottom: 2px solid #e6e6e6;</span>
<span class="s2">            padding-bottom: 10px;</span>
<span class="s2">            font-size: 1.5rem;</span>
<span class="s2">        }</span>
<span class="s2">        .stats-grid {</span>
<span class="s2">            display: grid;</span>
<span class="s2">            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));</span>
<span class="s2">            gap: 15px;</span>
<span class="s2">            margin-top: 15px;</span>
<span class="s2">        }</span>
<span class="s2">        .stat-box {</span>
<span class="s2">            background: #f9fafc;</span>
<span class="s2">            border-radius: 8px;</span>
<span class="s2">            padding: 15px;</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            border: 1px solid #e2e2e2;</span>
<span class="s2">        }</span>
<span class="s2">        table {</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            border-collapse: collapse;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            font-size: 0.95rem;</span>
<span class="s2">        }</span>
<span class="s2">        table th, table td {</span>
<span class="s2">            border: 1px solid #ddd;</span>
<span class="s2">            padding: 10px;</span>
<span class="s2">            text-align: left;</span>
<span class="s2">        }</span>
<span class="s2">        table th {</span>
<span class="s2">            background-color: #2980b9;</span>
<span class="s2">            color: #fff;</span>
<span class="s2">        }</span>
<span class="s2">        table tr:nth-child(even) {</span>
<span class="s2">            background-color: #f2f2f2;</span>
<span class="s2">        }</span>
<span class="s2">        .progress {</span>
<span class="s2">            background-color: #ddd;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            overflow: hidden;</span>
<span class="s2">            height: 18px;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            margin-top: 5px;</span>
<span class="s2">        }</span>
<span class="s2">        .progress-stacked {</span>
<span class="s2">            display: flex;</span>
<span class="s2">            height: 18px;</span>
<span class="s2">            border-radius: 10px;</span>
<span class="s2">            overflow: hidden;</span>
<span class="s2">            background-color: #ddd;</span>
<span class="s2">            font-size: 0.75rem;</span>
<span class="s2">            line-height: 18px;</span>
<span class="s2">            color: white;</span>
<span class="s2">            text-shadow: 0 1px 1px rgba(0,0,0,0.2);</span>
<span class="s2">            margin-bottom: 10px;</span>
<span class="s2">        }</span>
<span class="s2">        .progress-bar {</span>
<span class="s2">            display: flex;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            justify-content: center;</span>
<span class="s2">            height: 100%;</span>
<span class="s2">            white-space: nowrap;</span>
<span class="s2">            overflow: hidden;</span>
<span class="s2">        }</span>
<span class="s2">        .progress-bar-table {</span>
<span class="s2">            background-color: #27ae60;</span>
<span class="s2">            height: 100%;</span>
<span class="s2">            text-align: right;</span>
<span class="s2">            padding-right: 5px;</span>
<span class="s2">            color: white;</span>
<span class="s2">            font-size: 0.8rem;</span>
<span class="s2">            line-height: 18px;</span>
<span class="s2">        }</span>
<span class="s2">        .progress-multi {</span>
<span class="s2">            display: flex;</span>
<span class="s2">            width: 100%;</span>
<span class="s2">            height: 25px;</span>
<span class="s2">            border-radius: 12px;</span>
<span class="s2">            overflow: hidden;</span>
<span class="s2">            border: 1px solid #ccc;</span>
<span class="s2">        }</span>
<span class="s2">        .progress-segment {</span>
<span class="s2">            height: 100%;</span>
<span class="s2">        }</span>
<span class="s2">        .legend {</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-wrap: wrap;</span>
<span class="s2">            gap: 10px;</span>
<span class="s2">            font-size: 0.85rem;</span>
<span class="s2">            margin-top: 5px;</span>
<span class="s2">        }</span>
<span class="s2">        .legend-item {</span>
<span class="s2">            display: flex;</span>
<span class="s2">            align-items: center;</span>
<span class="s2">            gap: 5px;</span>
<span class="s2">        }</span>
<span class="s2">        .legend-color {</span>
<span class="s2">            width: 14px;</span>
<span class="s2">            height: 14px;</span>
<span class="s2">            border-radius: 3px;</span>
<span class="s2">            border: 1px solid #aaa;</span>
<span class="s2">        }</span>
<span class="s2">        .img-section {</span>
<span class="s2">            display: flex;</span>
<span class="s2">            flex-wrap: wrap;</span>
<span class="s2">            gap: 30px;</span>
<span class="s2">            justify-content: center;</span>
<span class="s2">            align-items: flex-start;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">        }</span>
<span class="s2">        footer {</span>
<span class="s2">            text-align: center;</span>
<span class="s2">            font-size: 0.9rem;</span>
<span class="s2">            color: #777;</span>
<span class="s2">            padding: 15px;</span>
<span class="s2">            margin-top: 20px;</span>
<span class="s2">            border-top: 1px solid #ddd;</span>
<span class="s2">        }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs.sticky", "navigation.expand", "navigation.tabs", "search.suggest", "search.highlight", "content.code.annotate", "content.code.copy", "content.code.fold", "toc.integrate", "admonition"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>